{"version":3,"sources":["src/Preloader.js","src/Easing.js","src/index.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["Preloader","options","assets","asset","loaded","complete","load","container","onprogress","undefined","domElement","document","createElement","style","position","top","left","width","height","background","opacity","display","alignItems","justifyContent","zIndex","barBase","minWidth","borderRadius","appendChild","bar","progressBar","body","oncomplete","loader","delta","progress","prop","total","url","xobj","XMLHttpRequest","open","onreadystatechange","readyState","status","checkCompleted","removeChild","e","send","Easing","start","end","duration","startTime","type","b","c","d","time","t","result","func","outQuad","inQuad","console","log","toFixed","Math","cos","PI","sin","pow","sqrt","s","p","a","abs","asin","outBounce","inBounce","ASSET_PATH","PI_2","PI_3","Game","modes","Object","freeze","NONE","Symbol","PRELOAD","INITIALISING","CREATING_LEVEL","ACTIVE","GAMEOVER","mode","getElementById","player","move","moveDir","action","camera","object","fade","stats","scene","renderer","controls","debug","game","anims","init","forEach","anim","push","clock","THREE","Clock","preloader","sky","ground","intensity","light1","AmbientLight","add","light","HemisphereLight","set","PointLight","rotation","textureLoader","TextureLoader","textureFlare0","textureFlare1","textureFlare2","lensflare","Lensflare","addElement","LensflareElement","geometry","BoxGeometry","material","MeshBasicMaterial","color","cube","Mesh","DirectionalLight","castShadow","shadow","mapSize","bottom","right","far","WebGLRenderer","antialias","setPixelRatio","window","devicePixelRatio","setSize","innerWidth","innerHeight","alpha","shadowMap","enabled","PCFSoftShadowMap","shadowMapDebug","addEventListener","onWindowResize","evt","key","indexOf","splice","length","onclick","switchCamera","col","Scene","Color","createCamera","initScene","hemisphereLight","directionalLight","loadFirstAnim","initRenderer","OrbitControls","Stats","dom","addWindowListeners","CubeTextureLoader","texture","receiveShadow","name","traverse","child","isMesh","includes","MeshPhysicalMaterial","reflectivity","transmission","roughness","metalness","clearcoat","clearcoatRoughness","ior","visible","environmentProxy","loadSkybox","loadNextAnim","onError","env","Group","BoxBufferGeometry","x","z","block","FBXLoader","mixer","AnimationMixer","root","getRoot","walk","animations","initCameras","loadEnvironment","pop","loop","initPlayerPosition","animate","initialOverlayAnim","overlay","classList","target","setTimeout","cameras","active","back","cams","keys","index","front","Object3D","parent","wide","overhead","collect","initialCameraAnim","fov","aspect","near","PerspectiveCamera","clientX","clientY","pos","Vector2","clientWidth","y","clientHeight","clipAction","timeScale","LoopOnce","stopAllAction","reset","setEffectiveTimeScale","setEffectiveWeight","fadeIn","play","actionTime","Date","now","dir","Vector3","clone","raycaster","Raycaster","gravity","intersect","intersectObject","distance","forward","turn","applyMatrix4","matrix","normalize","translateX","dt","targetY","velocityY","blocked","blockedForward","speed","translateZ","bBoxFloor","lookAt","lerp","getWorldPosition","cameraTarget","copy","getDelta","requestAnimationFrame","update","movePlayer","sum","i","moveCam","render","error","msg","JSON","stringify","message","updateProjectionMatrix","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","parse","handled","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","stack","createErrorOverlay","remove","stackTrace","innerText","innerHTML","getParents","modules","parents","k","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAAaA;EACT,mBAAYC,OAAZ,EAAqB;IAAA;;IACjB,KAAKC,MAAL,GAAc,EAAd;;IADiB,2CAECD,OAAO,CAACC,MAFT;IAAA;;IAAA;MAEjB,oDAAkC;QAAA,IAAzBC,KAAyB;QAC9B,KAAKD,MAAL,CAAYC,KAAZ,IAAqB;UAAEC,MAAM,EAAE,CAAV;UAAaC,QAAQ,EAAE;QAAvB,CAArB;QACA,KAAKC,IAAL,CAAUH,KAAV;MACH;IALgB;MAAA;IAAA;MAAA;IAAA;;IAMjB,KAAKI,SAAL,GAAiBN,OAAO,CAACM,SAAzB;;IAEA,IAAIN,OAAO,CAACO,UAAR,IAAsBC,SAA1B,EAAqC;MACjC,KAAKD,UAAL,GAAkBA,UAAlB;MACA,KAAKE,UAAL,GAAkBC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAlB;MACA,KAAKF,UAAL,CAAgBG,KAAhB,CAAsBC,QAAtB,GAAiC,UAAjC;MACA,KAAKJ,UAAL,CAAgBG,KAAhB,CAAsBE,GAAtB,GAA4B,GAA5B;MACA,KAAKL,UAAL,CAAgBG,KAAhB,CAAsBG,IAAtB,GAA6B,GAA7B;MACA,KAAKN,UAAL,CAAgBG,KAAhB,CAAsBI,KAAtB,GAA8B,MAA9B;MACA,KAAKP,UAAL,CAAgBG,KAAhB,CAAsBK,MAAtB,GAA+B,MAA/B;MACA,KAAKR,UAAL,CAAgBG,KAAhB,CAAsBM,UAAtB,GAAmC,MAAnC;MACA,KAAKT,UAAL,CAAgBG,KAAhB,CAAsBO,OAAtB,GAAgC,KAAhC;MACA,KAAKV,UAAL,CAAgBG,KAAhB,CAAsBQ,OAAtB,GAAgC,MAAhC;MACA,KAAKX,UAAL,CAAgBG,KAAhB,CAAsBS,UAAtB,GAAmC,QAAnC;MACA,KAAKZ,UAAL,CAAgBG,KAAhB,CAAsBU,cAAtB,GAAuC,QAAvC;MACA,KAAKb,UAAL,CAAgBG,KAAhB,CAAsBW,MAAtB,GAA+B,MAA/B;MACA,IAAMC,OAAO,GAAGd,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAhB;MACAa,OAAO,CAACZ,KAAR,CAAcM,UAAd,GAA2B,MAA3B;MACAM,OAAO,CAACZ,KAAR,CAAcI,KAAd,GAAsB,KAAtB;MACAQ,OAAO,CAACZ,KAAR,CAAca,QAAd,GAAyB,OAAzB;MACAD,OAAO,CAACZ,KAAR,CAAcc,YAAd,GAA6B,MAA7B;MACAF,OAAO,CAACZ,KAAR,CAAcK,MAAd,GAAuB,MAAvB;MACA,KAAKR,UAAL,CAAgBkB,WAAhB,CAA4BH,OAA5B;MACA,IAAMI,GAAG,GAAGlB,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAZ;MACAiB,GAAG,CAAChB,KAAJ,CAAUM,UAAV,GAAuB,MAAvB;MACAU,GAAG,CAAChB,KAAJ,CAAUI,KAAV,GAAkB,KAAlB;MACAY,GAAG,CAAChB,KAAJ,CAAUc,YAAV,GAAyB,MAAzB;MACAE,GAAG,CAAChB,KAAJ,CAAUK,MAAV,GAAmB,MAAnB;MACAW,GAAG,CAAChB,KAAJ,CAAUI,KAAV,GAAkB,GAAlB;MACAQ,OAAO,CAACG,WAAR,CAAoBC,GAApB;MACA,KAAKC,WAAL,GAAmBD,GAAnB;;MACA,IAAI,KAAKtB,SAAL,IAAkBE,SAAtB,EAAiC;QAC7B,KAAKF,SAAL,CAAeqB,WAAf,CAA2B,KAAKlB,UAAhC;MACH,CAFD,MAEO;QACHC,QAAQ,CAACoB,IAAT,CAAcH,WAAd,CAA0B,KAAKlB,UAA/B;MACH;IACJ,CAlCD,MAkCO;MACH,KAAKF,UAAL,GAAkBP,OAAO,CAACO,UAA1B;IACH;;IAED,KAAKwB,UAAL,GAAkB/B,OAAO,CAAC+B,UAA1B;IAEA,IAAMC,MAAM,GAAG,IAAf;;IACA,SAASzB,UAAT,CAAoB0B,KAApB,EAA2B;MACvB,IAAMC,QAAQ,GAAGD,KAAK,GAAG,GAAzB;MACAD,MAAM,CAACH,WAAP,CAAmBjB,KAAnB,CAAyBI,KAAzB,aAAoCkB,QAApC;IACH;EACJ;;;;WAED,0BAAiB;MACb,KAAK,IAAIC,IAAT,IAAiB,KAAKlC,MAAtB,EAA8B;QAC1B,IAAMC,KAAK,GAAG,KAAKD,MAAL,CAAYkC,IAAZ,CAAd;QACA,IAAI,CAACjC,KAAK,CAACE,QAAX,EAAqB,OAAO,KAAP;MACxB;;MACD,OAAO,IAAP;IACH;;;SAED,eAAe;MACX,IAAIgC,KAAK,GAAG,CAAZ;MACA,IAAIjC,MAAM,GAAG,CAAb;;MAEA,KAAK,IAAIgC,IAAT,IAAiB,KAAKlC,MAAtB,EAA8B;QAC1B,IAAMC,KAAK,GAAG,KAAKD,MAAL,CAAYkC,IAAZ,CAAd;;QACA,IAAIjC,KAAK,CAACkC,KAAN,IAAe5B,SAAnB,EAA8B;UAC1BL,MAAM,GAAG,CAAT;UACA;QACH;;QACDA,MAAM,IAAID,KAAK,CAACC,MAAhB;QACAiC,KAAK,IAAIlC,KAAK,CAACkC,KAAf;MACH;;MAED,OAAOjC,MAAM,GAAGiC,KAAhB;IACH;;;WAED,cAAKC,GAAL,EAAU;MACN,IAAML,MAAM,GAAG,IAAf;MACA,IAAIM,IAAI,GAAG,IAAIC,cAAJ,EAAX;MACAD,IAAI,CAACE,IAAL,CAAU,KAAV,EAAiBH,GAAjB,EAAsB,IAAtB;;MACAC,IAAI,CAACG,kBAAL,GAA0B,YAAY;QAClC,IAAIH,IAAI,CAACI,UAAL,IAAmB,CAAnB,IAAwBJ,IAAI,CAACK,MAAL,IAAe,KAA3C,EAAkD;UAC9CX,MAAM,CAAC/B,MAAP,CAAcoC,GAAd,EAAmBjC,QAAnB,GAA8B,IAA9B;;UACA,IAAI4B,MAAM,CAACY,cAAP,EAAJ,EAA6B;YACzB,IAAIZ,MAAM,CAACvB,UAAP,IAAqBD,SAAzB,EAAoC;cAChC,IAAIwB,MAAM,CAAC1B,SAAP,IAAoBE,SAAxB,EAAmC;gBAC/BwB,MAAM,CAAC1B,SAAP,CAAiBuC,WAAjB,CAA6Bb,MAAM,CAACvB,UAApC;cACH,CAFD,MAEO;gBACHC,QAAQ,CAACoB,IAAT,CAAce,WAAd,CAA0Bb,MAAM,CAACvB,UAAjC;cACH;YACJ;;YACDuB,MAAM,CAACD,UAAP;UACH;QACJ;MACJ,CAdD;;MAeAO,IAAI,CAAC/B,UAAL,GAAkB,UAAUuC,CAAV,EAAa;QAC3B,IAAM5C,KAAK,GAAG8B,MAAM,CAAC/B,MAAP,CAAcoC,GAAd,CAAd;QACAnC,KAAK,CAACC,MAAN,GAAe2C,CAAC,CAAC3C,MAAjB;QACAD,KAAK,CAACkC,KAAN,GAAcU,CAAC,CAACV,KAAhB;QACAJ,MAAM,CAACzB,UAAP,CAAkByB,MAAM,CAACE,QAAzB;MACH,CALD;;MAMAI,IAAI,CAACS,IAAL,CAAU,IAAV;IACH;;;;;;;;;;;;;;;;;;;;;IC3GQC;EACT;EACA,gBAAYC,KAAZ,EAAmBC,GAAnB,EAAwBC,QAAxB,EAAkE;IAAA,IAAhCC,SAAgC,uEAApB,CAAoB;IAAA,IAAjBC,IAAiB,uEAAV,QAAU;;IAAA;;IAC9D,KAAKC,CAAL,GAASL,KAAT;IACA,KAAKM,CAAL,GAASL,GAAG,GAAGD,KAAf;IACA,KAAKO,CAAL,GAASL,QAAT;IACA,KAAKE,IAAL,GAAYA,IAAZ;IACA,KAAKD,SAAL,GAAiBA,SAAjB;EACH;;;;WAED,eAAMK,IAAN,EAAY;MACR,KAAKC,CAAL,GAASD,IAAI,GAAG,KAAKL,SAArB;MACA,OAAO,KAAK,KAAKC,IAAV,GAAP;IACH;;;WAED,kBAAS;MACL,OAAO,KAAKE,CAAL,IAAU,KAAKG,CAAL,GAAS,KAAKF,CAAxB,IAA6B,KAAKF,CAAzC;IACH;;;WAED,kBAAS;MACL,OAAO,KAAKC,CAAL,IAAU,KAAKG,CAAL,IAAU,KAAKF,CAAzB,IAA8B,KAAKE,CAAnC,GAAuC,KAAKJ,CAAnD;IACH;;;WAED,mBAAU;MACN,OAAO,CAAC,KAAKC,CAAN,IAAW,KAAKG,CAAL,IAAU,KAAKF,CAA1B,KAAgC,KAAKE,CAAL,GAAS,CAAzC,IAA8C,KAAKJ,CAA1D;IACH;;;WAED,qBAAY;MACR,IAAI,CAAC,KAAKI,CAAL,IAAU,KAAKF,CAAL,GAAS,CAApB,IAAyB,CAA7B,EACI,OAAQ,KAAKD,CAAL,GAAS,CAAV,GAAe,KAAKG,CAApB,GAAwB,KAAKA,CAA7B,GAAiC,KAAKJ,CAA7C;MACJ,OAAQ,CAAC,KAAKC,CAAN,GAAU,CAAX,IAAiB,EAAE,KAAKG,CAAP,IAAY,KAAKA,CAAL,GAAS,CAArB,IAA0B,CAA3C,IAAgD,KAAKJ,CAA5D;IACH;;;WAED,sBAAa;MACT,IAAIC,CAAC,GAAG,KAAKA,CAAb;MACA,IAAID,CAAC,GAAG,KAAKA,CAAb;MACA,IAAII,CAAC,GAAG,KAAKA,CAAb;MACA,KAAKA,CAAL,IAAU,CAAV;MACA,IAAIC,MAAJ;MACA,IAAIC,IAAJ;;MACA,IAAI,KAAKF,CAAL,GAAS,KAAKF,CAAlB,EAAqB;QACjBG,MAAM,GAAG,KAAKE,OAAL,EAAT;QACAD,IAAI,GAAG,SAAP;MACH,CAHD,MAGO;QACH,KAAKF,CAAL,IAAU,KAAKF,CAAf;QACA,KAAKF,CAAL,IAAUC,CAAV;QACA,KAAKA,CAAL,GAAS,CAACA,CAAV;QACAI,MAAM,GAAG,KAAKG,MAAL,EAAT;QACAF,IAAI,GAAG,QAAP;MACH;;MACDG,OAAO,CAACC,GAAR,CACI,iBACAL,MAAM,CAACM,OAAP,CAAe,CAAf,CADA,GAEA,QAFA,GAGA,KAAKP,CAAL,CAAOO,OAAP,CAAe,CAAf,CAHA,GAIA,QAJA,GAKAL,IANJ;MAQA,KAAKN,CAAL,GAASA,CAAT;MACA,KAAKC,CAAL,GAASA,CAAT;MACA,KAAKG,CAAL,GAASA,CAAT;MACA,OAAOC,MAAP;IACH;;;WAED,mBAAU;MACN,OAAO,KAAKJ,CAAL,IAAU,KAAKG,CAAL,IAAU,KAAKF,CAAzB,IAA8B,KAAKE,CAAnC,GAAuC,KAAKA,CAA5C,GAAgD,KAAKJ,CAA5D;IACH;;;WAED,oBAAW;MACP,OACI,KAAKC,CAAL,IAAU,CAAC,KAAKG,CAAL,GAAS,KAAKA,CAAL,GAAS,KAAKF,CAAd,GAAkB,CAA5B,IAAiC,KAAKE,CAAtC,GAA0C,KAAKA,CAA/C,GAAmD,CAA7D,IAAkE,KAAKJ,CAD3E;IAGH;;;WAED,sBAAa;MACT,IAAI,CAAC,KAAKI,CAAL,IAAU,KAAKF,CAAL,GAAS,CAApB,IAAyB,CAA7B,EACI,OAAQ,KAAKD,CAAL,GAAS,CAAV,GAAe,KAAKG,CAApB,GAAwB,KAAKA,CAA7B,GAAiC,KAAKA,CAAtC,GAA0C,KAAKJ,CAAtD;MACJ,OAAQ,KAAKC,CAAL,GAAS,CAAV,IAAgB,CAAC,KAAKG,CAAL,IAAU,CAAX,IAAgB,KAAKA,CAArB,GAAyB,KAAKA,CAA9B,GAAkC,CAAlD,IAAuD,KAAKJ,CAAnE;IACH;;;WAED,mBAAU;MACN,OAAO,KAAKC,CAAL,IAAU,KAAKG,CAAL,IAAU,KAAKF,CAAzB,IAA8B,KAAKE,CAAnC,GAAuC,KAAKA,CAA5C,GAAgD,KAAKA,CAArD,GAAyD,KAAKJ,CAArE;IACH;;;WAED,oBAAW;MACP,OACI,CAAC,KAAKC,CAAN,IACC,CAAC,KAAKG,CAAL,GAAS,KAAKA,CAAL,GAAS,KAAKF,CAAd,GAAkB,CAA5B,IAAiC,KAAKE,CAAtC,GAA0C,KAAKA,CAA/C,GAAmD,KAAKA,CAAxD,GAA4D,CAD7D,IAEA,KAAKJ,CAHT;IAKH;;;WAED,sBAAa;MACT,IAAI,CAAC,KAAKI,CAAL,IAAU,KAAKF,CAAL,GAAS,CAApB,IAAyB,CAA7B,EACI,OAAQ,KAAKD,CAAL,GAAS,CAAV,GAAe,KAAKG,CAApB,GAAwB,KAAKA,CAA7B,GAAiC,KAAKA,CAAtC,GAA0C,KAAKA,CAA/C,GAAmD,KAAKJ,CAA/D;MACJ,OACK,CAAC,KAAKC,CAAN,GAAU,CAAX,IAAiB,CAAC,KAAKG,CAAL,IAAU,CAAX,IAAgB,KAAKA,CAArB,GAAyB,KAAKA,CAA9B,GAAkC,KAAKA,CAAvC,GAA2C,CAA5D,IAAiE,KAAKJ,CAD1E;IAGH;;;WAED,mBAAU;MACN,OACI,KAAKC,CAAL,IAAU,KAAKG,CAAL,IAAU,KAAKF,CAAzB,IAA8B,KAAKE,CAAnC,GAAuC,KAAKA,CAA5C,GAAgD,KAAKA,CAArD,GAAyD,KAAKA,CAA9D,GAAkE,KAAKJ,CAD3E;IAGH;;;WAED,oBAAW;MACP,OACI,KAAKC,CAAL,IACC,CAAC,KAAKG,CAAL,GAAS,KAAKA,CAAL,GAAS,KAAKF,CAAd,GAAkB,CAA5B,IAAiC,KAAKE,CAAtC,GAA0C,KAAKA,CAA/C,GAAmD,KAAKA,CAAxD,GAA4D,KAAKA,CAAjE,GACG,CAFJ,IAGA,KAAKJ,CAJT;IAMH;;;WAED,sBAAa;MACT,IAAI,CAAC,KAAKI,CAAL,IAAU,KAAKF,CAAL,GAAS,CAApB,IAAyB,CAA7B,EACI,OAAQ,KAAKD,CAAL,GAAS,CAAV,GAAe,KAAKG,CAApB,GAAwB,KAAKA,CAA7B,GAAiC,KAAKA,CAAtC,GAA0C,KAAKA,CAA/C,GAAmD,KAAKA,CAAxD,GAA4D,KAAKJ,CAAxE;MACJ,OACK,KAAKC,CAAL,GAAS,CAAV,IAAgB,CAAC,KAAKG,CAAL,IAAU,CAAX,IAAgB,KAAKA,CAArB,GAAyB,KAAKA,CAA9B,GAAkC,KAAKA,CAAvC,GAA2C,KAAKA,CAAhD,GAAoD,CAApE,IACA,KAAKJ,CAFT;IAIH;;;WAED,kBAAS;MACL,OACI,CAAC,KAAKC,CAAN,GAAUW,IAAI,CAACC,GAAL,CAAU,KAAKT,CAAL,GAAS,KAAKF,CAAf,IAAqBU,IAAI,CAACE,EAAL,GAAU,CAA/B,CAAT,CAAV,GAAwD,KAAKb,CAA7D,GAAiE,KAAKD,CAD1E;IAGH;;;WAED,mBAAU;MACN,OAAO,KAAKC,CAAL,GAASW,IAAI,CAACG,GAAL,CAAU,KAAKX,CAAL,GAAS,KAAKF,CAAf,IAAqBU,IAAI,CAACE,EAAL,GAAU,CAA/B,CAAT,CAAT,GAAuD,KAAKd,CAAnE;IACH;;;WAED,qBAAY;MACR,OAAQ,CAAC,KAAKC,CAAN,GAAU,CAAX,IAAiBW,IAAI,CAACC,GAAL,CAAUD,IAAI,CAACE,EAAL,GAAU,KAAKV,CAAhB,GAAqB,KAAKF,CAAnC,IAAwC,CAAzD,IAA8D,KAAKF,CAA1E;IACH;;;WAED,kBAAS;MACL,OAAO,KAAKI,CAAL,IAAU,CAAV,GACD,KAAKJ,CADJ,GAED,KAAKC,CAAL,GAASW,IAAI,CAACI,GAAL,CAAS,CAAT,EAAY,MAAM,KAAKZ,CAAL,GAAS,KAAKF,CAAd,GAAkB,CAAxB,CAAZ,CAAT,GAAmD,KAAKF,CAF9D;IAGH;;;WAED,mBAAU;MACN,OAAO,KAAKI,CAAL,IAAU,KAAKF,CAAf,GACD,KAAKF,CAAL,GAAS,KAAKC,CADb,GAED,KAAKA,CAAL,IAAU,CAACW,IAAI,CAACI,GAAL,CAAS,CAAT,EAAa,CAAC,EAAD,GAAM,KAAKZ,CAAZ,GAAiB,KAAKF,CAAlC,CAAD,GAAwC,CAAlD,IAAuD,KAAKF,CAFlE;IAGH;;;WAED,qBAAY;MACR,IAAI,KAAKI,CAAL,IAAU,CAAd,EAAiB,OAAO,KAAKJ,CAAZ;MACjB,IAAI,KAAKI,CAAL,IAAU,KAAKF,CAAnB,EAAsB,OAAO,KAAKF,CAAL,GAAS,KAAKC,CAArB;MACtB,IAAI,CAAC,KAAKG,CAAL,IAAU,KAAKF,CAAL,GAAS,CAApB,IAAyB,CAA7B,EACI,OAAQ,KAAKD,CAAL,GAAS,CAAV,GAAeW,IAAI,CAACI,GAAL,CAAS,CAAT,EAAY,MAAM,KAAKZ,CAAL,GAAS,CAAf,CAAZ,CAAf,GAAgD,KAAKJ,CAA5D;MACJ,OAAQ,KAAKC,CAAL,GAAS,CAAV,IAAgB,CAACW,IAAI,CAACI,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAM,EAAE,KAAKZ,CAAzB,CAAD,GAA+B,CAA/C,IAAoD,KAAKJ,CAAhE;IACH;;;WAED,kBAAS;MACL,OAAO,CAAC,KAAKC,CAAN,IAAWW,IAAI,CAACK,IAAL,CAAU,IAAI,CAAC,KAAKb,CAAL,IAAU,KAAKF,CAAhB,IAAqB,KAAKE,CAAxC,IAA6C,CAAxD,IAA6D,KAAKJ,CAAzE;IACH;;;WAED,mBAAU;MACN,OACI,KAAKC,CAAL,GAASW,IAAI,CAACK,IAAL,CAAU,IAAI,CAAC,KAAKb,CAAL,GAAS,KAAKA,CAAL,GAAS,KAAKF,CAAd,GAAkB,CAA5B,IAAiC,KAAKE,CAApD,CAAT,GAAkE,KAAKJ,CAD3E;IAGH;;;WAED,qBAAY;MACR,IAAI,CAAC,KAAKI,CAAL,IAAU,KAAKF,CAAL,GAAS,CAApB,IAAyB,CAA7B,EACI,OAAQ,CAAC,KAAKD,CAAN,GAAU,CAAX,IAAiBW,IAAI,CAACK,IAAL,CAAU,IAAI,KAAKb,CAAL,GAAS,KAAKA,CAA5B,IAAiC,CAAlD,IAAuD,KAAKJ,CAAnE;MACJ,OAAQ,KAAKC,CAAL,GAAS,CAAV,IAAgBW,IAAI,CAACK,IAAL,CAAU,IAAI,CAAC,KAAKb,CAAL,IAAU,CAAX,IAAgB,KAAKA,CAAnC,IAAwC,CAAxD,IAA6D,KAAKJ,CAAzE;IACH;;;WAED,qBAAY;MACR,IAAIkB,CAAC,GAAG,OAAR;MAAA,IACIC,CAAC,GAAG,CADR;MAAA,IAEIC,CAAC,GAAG,KAAKnB,CAFb;MAGA,IAAI,KAAKG,CAAL,IAAU,CAAd,EAAiB,OAAO,KAAKJ,CAAZ;MACjB,IAAI,CAAC,KAAKI,CAAL,IAAU,KAAKF,CAAhB,KAAsB,CAA1B,EAA6B,OAAO,KAAKF,CAAL,GAAS,KAAKC,CAArB;MAC7B,IAAI,CAACkB,CAAL,EAAQA,CAAC,GAAG,KAAKjB,CAAL,GAAS,GAAb;;MACR,IAAIkB,CAAC,GAAGR,IAAI,CAACS,GAAL,CAAS,KAAKpB,CAAd,CAAR,EAA0B;QACtBmB,CAAC,GAAG,KAAKnB,CAAT;;QACA,IAAIiB,EAAC,GAAGC,CAAC,GAAG,CAAZ;MACH,CAHD,MAGO;QACH,IAAID,GAAC,GAAIC,CAAC,IAAI,IAAIP,IAAI,CAACE,EAAb,CAAF,GAAsBF,IAAI,CAACU,IAAL,CAAU,KAAKrB,CAAL,GAASmB,CAAnB,CAA9B;MACH;;MACD,OACI,EACIA,CAAC,GACDR,IAAI,CAACI,GAAL,CAAS,CAAT,EAAY,MAAM,KAAKZ,CAAL,IAAU,CAAhB,CAAZ,CADA,GAEAQ,IAAI,CAACG,GAAL,CAAU,CAAC,KAAKX,CAAL,GAAS,KAAKF,CAAd,GAAkBgB,CAAnB,KAAyB,IAAIN,IAAI,CAACE,EAAlC,CAAD,GAA0CK,CAAnD,CAHJ,IAII,KAAKnB,CALb;IAOH;;;WAED,sBAAa;MACT,IAAIkB,CAAC,GAAG,OAAR;MAAA,IACIC,CAAC,GAAG,CADR;MAAA,IAEIC,CAAC,GAAG,KAAKnB,CAFb;MAGA,IAAI,KAAKG,CAAL,IAAU,CAAd,EAAiB,OAAO,KAAKJ,CAAZ;MACjB,IAAI,CAAC,KAAKI,CAAL,IAAU,KAAKF,CAAhB,KAAsB,CAA1B,EAA6B,OAAO,KAAKF,CAAL,GAAS,KAAKC,CAArB;MAC7B,IAAI,CAACkB,CAAL,EAAQA,CAAC,GAAG,KAAKjB,CAAL,GAAS,GAAb;;MACR,IAAIkB,CAAC,GAAGR,IAAI,CAACS,GAAL,CAAS,KAAKpB,CAAd,CAAR,EAA0B;QACtBmB,CAAC,GAAG,KAAKnB,CAAT;;QACA,IAAIiB,GAAC,GAAGC,CAAC,GAAG,CAAZ;MACH,CAHD,MAGO;QACH,IAAID,GAAC,GAAIC,CAAC,IAAI,IAAIP,IAAI,CAACE,EAAb,CAAF,GAAsBF,IAAI,CAACU,IAAL,CAAU,KAAKrB,CAAL,GAASmB,CAAnB,CAA9B;MACH;;MACD,OACIA,CAAC,GACDR,IAAI,CAACI,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAM,KAAKZ,CAAvB,CADA,GAEAQ,IAAI,CAACG,GAAL,CAAU,CAAC,KAAKX,CAAL,GAAS,KAAKF,CAAd,GAAkBgB,CAAnB,KAAyB,IAAIN,IAAI,CAACE,EAAlC,CAAD,GAA0CK,CAAnD,CAFA,GAGA,KAAKlB,CAHL,GAIA,KAAKD,CALT;IAOH;;;WAED,wBAAe;MACX,IAAIkB,CAAC,GAAG,OAAR;MAAA,IACIC,CAAC,GAAG,CADR;MAAA,IAEIC,CAAC,GAAG,KAAKnB,CAFb;MAGA,IAAI,KAAKG,CAAL,IAAU,CAAd,EAAiB,OAAO,KAAKJ,CAAZ;MACjB,IAAI,CAAC,KAAKI,CAAL,IAAU,KAAKF,CAAL,GAAS,CAApB,KAA0B,CAA9B,EAAiC,OAAO,KAAKF,CAAL,GAAS,KAAKC,CAArB;MACjC,IAAI,CAACkB,CAAL,EAAQA,CAAC,GAAG,KAAKjB,CAAL,IAAU,MAAM,GAAhB,CAAJ;;MACR,IAAIkB,CAAC,GAAGR,IAAI,CAACS,GAAL,CAAS,KAAKpB,CAAd,CAAR,EAA0B;QACtBmB,CAAC,GAAG,KAAKnB,CAAT;;QACA,IAAIiB,GAAC,GAAGC,CAAC,GAAG,CAAZ;MACH,CAHD,MAGO;QACH,IAAID,GAAC,GAAIC,CAAC,IAAI,IAAIP,IAAI,CAACE,EAAb,CAAF,GAAsBF,IAAI,CAACU,IAAL,CAAU,KAAKrB,CAAL,GAASmB,CAAnB,CAA9B;MACH;;MACD,IAAI,KAAKhB,CAAL,GAAS,CAAb,EACI,OACI,CAAC,GAAD,IACCgB,CAAC,GACER,IAAI,CAACI,GAAL,CAAS,CAAT,EAAY,MAAM,KAAKZ,CAAL,IAAU,CAAhB,CAAZ,CADH,GAEGQ,IAAI,CAACG,GAAL,CAAU,CAAC,KAAKX,CAAL,GAAS,KAAKF,CAAd,GAAkBgB,CAAnB,KAAyB,IAAIN,IAAI,CAACE,EAAlC,CAAD,GAA0CK,CAAnD,CAHJ,IAIA,KAAKnB,CALT;MAOJ,OACIoB,CAAC,GACDR,IAAI,CAACI,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,IAAO,KAAKZ,CAAL,IAAU,CAAjB,CAAZ,CADA,GAEAQ,IAAI,CAACG,GAAL,CAAU,CAAC,KAAKX,CAAL,GAAS,KAAKF,CAAd,GAAkBgB,CAAnB,KAAyB,IAAIN,IAAI,CAACE,EAAlC,CAAD,GAA0CK,CAAnD,CAFA,GAGA,GAHA,GAIA,KAAKlB,CAJL,GAKA,KAAKD,CANT;IAQH;;;WAED,kBAAS;MACL,IAAIkB,CAAC,GAAG,OAAR;MACA,OACI,KAAKjB,CAAL,IAAU,KAAKG,CAAL,IAAU,KAAKF,CAAzB,IAA8B,KAAKE,CAAnC,IAAwC,CAACc,CAAC,GAAG,CAAL,IAAU,KAAKd,CAAf,GAAmBc,CAA3D,IAAgE,KAAKlB,CADzE;IAGH;;;WAED,mBAAU;MACN,IAAIkB,CAAC,GAAG,OAAR;MACA,OACI,KAAKjB,CAAL,IACC,CAAC,KAAKG,CAAL,GAAS,KAAKA,CAAL,GAAS,KAAKF,CAAd,GAAkB,CAA5B,IAAiC,KAAKE,CAAtC,IAA2C,CAACc,CAAC,GAAG,CAAL,IAAU,KAAKd,CAAf,GAAmBc,CAA9D,IAAmE,CADpE,IAEA,KAAKlB,CAHT;IAKH;;;WAED,qBAAY;MACR,IAAIkB,CAAC,GAAG,OAAR;MACA,IAAI,CAAC,KAAKd,CAAL,IAAU,KAAKF,CAAL,GAAS,CAApB,IAAyB,CAA7B,EACI,OACK,KAAKD,CAAL,GAAS,CAAV,IAAgB,KAAKG,CAAL,GAAS,KAAKA,CAAd,IAAmB,CAAC,CAACc,CAAC,IAAI,KAAN,IAAe,CAAhB,IAAqB,KAAKd,CAA1B,GAA8Bc,CAAjD,CAAhB,IACA,KAAKlB,CAFT;MAIJ,OACK,KAAKC,CAAL,GAAS,CAAV,IACC,CAAC,KAAKG,CAAL,IAAU,CAAX,IAAgB,KAAKA,CAArB,IAA0B,CAAC,CAACc,CAAC,IAAI,KAAN,IAAe,CAAhB,IAAqB,KAAKd,CAA1B,GAA8Bc,CAAxD,IAA6D,CAD9D,IAEA,KAAKlB,CAHT;IAKH;;;WAED,oBAAiC;MAAA,IAAxBI,CAAwB,uEAApB,KAAKA,CAAe;MAAA,IAAZJ,CAAY,uEAAR,KAAKA,CAAG;MAC7B,OAAO,KAAKC,CAAL,GAAS,KAAKsB,SAAL,CAAe,KAAKrB,CAAL,GAASE,CAAxB,EAA2B,CAA3B,CAAT,GAAyCJ,CAAhD;IACH;;;WAED,qBAAkC;MAAA,IAAxBI,CAAwB,uEAApB,KAAKA,CAAe;MAAA,IAAZJ,CAAY,uEAAR,KAAKA,CAAG;;MAC9B,IAAI,CAACI,CAAC,IAAI,KAAKF,CAAX,IAAgB,IAAI,IAAxB,EAA8B;QAC1B,OAAO,KAAKD,CAAL,IAAU,SAASG,CAAT,GAAaA,CAAvB,IAA4BJ,CAAnC;MACH,CAFD,MAEO,IAAII,CAAC,GAAG,IAAI,IAAZ,EAAkB;QACrB,OAAO,KAAKH,CAAL,IAAU,UAAUG,CAAC,IAAI,MAAM,IAArB,IAA6BA,CAA7B,GAAiC,IAA3C,IAAmDJ,CAA1D;MACH,CAFM,MAEA,IAAII,CAAC,GAAG,MAAM,IAAd,EAAoB;QACvB,OAAO,KAAKH,CAAL,IAAU,UAAUG,CAAC,IAAI,OAAO,IAAtB,IAA8BA,CAA9B,GAAkC,MAA5C,IAAsDJ,CAA7D;MACH,CAFM,MAEA;QACH,OAAO,KAAKC,CAAL,IAAU,UAAUG,CAAC,IAAI,QAAQ,IAAvB,IAA+BA,CAA/B,GAAmC,QAA7C,IAAyDJ,CAAhE;MACH;IACJ;;;WAED,uBAAc;MACV,IAAI,KAAKI,CAAL,GAAS,KAAKF,CAAL,GAAS,CAAtB,EAAyB,OAAO,KAAKsB,QAAL,CAAc,KAAKpB,CAAL,GAAS,CAAvB,EAA0B,CAA1B,IAA+B,GAA/B,GAAqC,KAAKJ,CAAjD;MACzB,OAAO,KAAKuB,SAAL,CAAe,KAAKnB,CAAL,GAAS,CAAT,GAAa,KAAKF,CAAjC,EAAoC,CAApC,IAAyC,GAAzC,GAA+C,KAAKD,CAAL,GAAS,GAAxD,GAA8D,KAAKD,CAA1E;IACH;;;;;;;;;;AC1SL;;AACA;;;;;;;;AACA,IAAMyB,UAAU,GAAG,0DAAnB;AACA,IAAMX,EAAE,GAAG,WAAX;AACA,IAAMY,IAAI,GAAG,WAAb;AACA,IAAMC,IAAI,GAAI,IAAIf,IAAI,CAACE,EAAV,GAAgB,CAA7B;;IACMc;EACF,gBAAc;IAAA;;IACV,KAAKC,KAAL,GAAaC,MAAM,CAACC,MAAP,CAAc;MACvBC,IAAI,EAAEC,MAAM,CAAC,MAAD,CADW;MAEvBC,OAAO,EAAED,MAAM,CAAC,SAAD,CAFQ;MAGvBE,YAAY,EAAEF,MAAM,CAAC,cAAD,CAHG;MAIvBG,cAAc,EAAEH,MAAM,CAAC,gBAAD,CAJC;MAKvBI,MAAM,EAAEJ,MAAM,CAAC,QAAD,CALS;MAMvBK,QAAQ,EAAEL,MAAM,CAAC,UAAD;IANO,CAAd,CAAb;IAQA,KAAKM,IAAL,GAAY,KAAKV,KAAL,CAAWG,IAAvB;IAEA,KAAKhF,SAAL,GAAiBI,QAAQ,CAACoF,cAAT,CAAwB,iBAAxB,CAAjB;IACA,KAAKC,MAAL,GAAc;MACVC,IAAI,EAAE,CADI;MAEVC,OAAO,EAAE,EAFC;MAGVC,MAAM,EAAE;IAHE,CAAd;IAKA,KAAKC,MAAL,GAAc;MAAEC,MAAM,EAAE,EAAV;MAAcC,IAAI,EAAE;IAApB,CAAd;IACA,KAAKC,KAAL;IACA,KAAKC,KAAL;IACA,KAAKC,QAAL;IACA,KAAKC,QAAL;IACA,KAAKC,KAAL,GAAa,IAAb;IACA,IAAMC,IAAI,GAAG,IAAb;IACA,KAAKC,KAAL,GAAa,CACT,aADS,EAET,eAFS,EAGT,gBAHS,EAIT,aAJS,EAKT,KALS,CAAb;IAOA,IAAM5G,OAAO,GAAG;MACZC,MAAM,EAAE,EADI;MAGZ8B,UAAU,EAAE,sBAAY;QACpB4E,IAAI,CAACE,IAAL;MACH;IALW,CAAhB;IAOA,KAAKD,KAAL,CAAWE,OAAX,CAAmB,UAAUC,IAAV,EAAgB;MAC/B/G,OAAO,CAACC,MAAR,CAAe+G,IAAf,WAAuBjC,UAAvB,SAAoCgC,IAApC;IACH,CAFD;IAIA,KAAKlB,IAAL,GAAY,KAAKV,KAAL,CAAWK,OAAvB;IAEA,KAAKyB,KAAL,GAAa,IAAIC,KAAK,CAACC,KAAV,EAAb;IACA,IAAMC,SAAS,GAAG,IAAIrH,oBAAJ,CAAcC,OAAd,CAAlB;EACH;;;;WAGD,2BAAkE;MAAA,IAAlDqH,GAAkD,uEAA5C,QAA4C;MAAA,IAAlCC,MAAkC,uEAAzB,QAAyB;MAAA,IAAfC,SAAe,uEAAH,CAAG;MAC9D,IAAMC,MAAM,GAAG,IAAIN,KAAK,CAACO,YAAV,CAAuB,QAAvB,CAAf,CAD8D,CACb;;MACjD,KAAKlB,KAAL,CAAWmB,GAAX,CAAeF,MAAf;MACA,IAAMG,KAAK,GAAG,IAAIT,KAAK,CAACU,eAAV,CAA0BP,GAA1B,EAA+BC,MAA/B,EAAuCC,SAAvC,CAAd;MACAI,KAAK,CAAC9G,QAAN,CAAegH,GAAf,CAAmB,CAAnB,EAAsB,GAAtB,EAA2B,CAA3B;MACA,OAAOF,KAAP;IACH;;;WAED,qBAAY;MACR,IAAMA,KAAK,GAAG,IAAIT,KAAK,CAACY,UAAV,CAAqB,QAArB,EAA+B,GAA/B,EAAoC,IAApC,CAAd;MACAH,KAAK,CAAC9G,QAAN,CAAegH,GAAf,CAAmB,CAAC,CAAD,EAAI,CAAJ,EAAO,EAAP,CAAnB;MACAF,KAAK,CAACI,QAAN,CAAeF,GAAf,CAAmB,CAAC,CAAD,EAAI,EAAJ,EAAQ,CAAR,CAAnB;MACA,IAAMG,aAAa,GAAG,IAAId,KAAK,CAACe,aAAV,EAAtB;MAEA,IAAMC,aAAa,GAAGF,aAAa,CAAC3H,IAAd,WAAsB0E,UAAtB,sBAAtB;MACA,IAAMoD,aAAa,GAAGH,aAAa,CAAC3H,IAAd,WAAsB0E,UAAtB,uBAAtB;MACA,IAAMqD,aAAa,GAAGJ,aAAa,CAAC3H,IAAd,WAAsB0E,UAAtB,uBAAtB;MAEA,IAAMsD,SAAS,GAAG,IAAInB,KAAK,CAACoB,SAAV,EAAlB;MACAD,SAAS,CAACE,UAAV,CAAqB,IAAIrB,KAAK,CAACsB,gBAAV,CAA2BN,aAA3B,EAA0C,GAA1C,EAA+C,CAA/C,CAArB;MACAG,SAAS,CAACE,UAAV,CAAqB,IAAIrB,KAAK,CAACsB,gBAAV,CAA2BL,aAA3B,EAA0C,GAA1C,EAA+C,EAA/C,CAArB;MACAE,SAAS,CAACE,UAAV,CAAqB,IAAIrB,KAAK,CAACsB,gBAAV,CAA2BJ,aAA3B,EAA0C,EAA1C,EAA8C,GAA9C,CAArB;MAEA,IAAMK,QAAQ,GAAG,IAAIvB,KAAK,CAACwB,WAAV,CAAsB,CAAtB,EAAyB,EAAzB,EAA6B,CAA7B,CAAjB;MACA,IAAMC,QAAQ,GAAG,IAAIzB,KAAK,CAAC0B,iBAAV,CAA4B;QAAEC,KAAK,EAAE;MAAT,CAA5B,CAAjB;MACA,IAAMC,IAAI,GAAG,IAAI5B,KAAK,CAAC6B,IAAV,CAAeN,QAAf,EAAyBE,QAAzB,CAAb;MACA,KAAKG,IAAL,CAAUjI,QAAV,GAAqB,CAAC,CAAD,EAAI,EAAJ,EAAQ,CAAR,CAArB;MACA,KAAK0F,KAAL,CAAWmB,GAAX,CAAeoB,IAAf;MAEAnB,KAAK,CAACD,GAAN,CAAUW,SAAV;IACH;;;WACD,4BAAmC;MAAA,IAAlBQ,KAAkB,uEAAV,QAAU;MAC/B,IAAMlB,KAAK,GAAG,IAAIT,KAAK,CAAC8B,gBAAV,CAA2BH,KAA3B,CAAd;MACAlB,KAAK,CAAC9G,QAAN,CAAegH,GAAf,CAAmB,EAAnB,EAAuB,EAAvB,EAA2B,EAA3B;MACAF,KAAK,CAACI,QAAN,CAAeF,GAAf,CAAmB,CAAC,CAAD,EAAI,CAAC,OAAL,EAAc,CAAd,CAAnB;MACAF,KAAK,CAACsB,UAAN,GAAmB,IAAnB;MACAtB,KAAK,CAACuB,MAAN,CAAaC,OAAb,CAAqBnI,KAArB,GAA6B,IAA7B;MACA2G,KAAK,CAACuB,MAAN,CAAaC,OAAb,CAAqBlI,MAArB,GAA8B,IAA9B;MACA0G,KAAK,CAACuB,MAAN,CAAa/C,MAAb,CAAoBrF,GAApB,GAA0B,IAA1B;MACA6G,KAAK,CAACuB,MAAN,CAAa/C,MAAb,CAAoBiD,MAApB,GAA6B,CAAC,IAA9B;MACAzB,KAAK,CAACuB,MAAN,CAAa/C,MAAb,CAAoBpF,IAApB,GAA2B,CAAC,IAA5B;MACA4G,KAAK,CAACuB,MAAN,CAAa/C,MAAb,CAAoBkD,KAApB,GAA4B,IAA5B;MACA1B,KAAK,CAACuB,MAAN,CAAa/C,MAAb,CAAoBmD,GAApB,GAA0B,IAA1B,CAX+B,CAY/B;;MACA,OAAQ3B,KAAR;IACH;;;WAID,wBAAe;MACX,KAAKnB,QAAL,GAAgB,IAAIU,KAAK,CAACqC,aAAV,CAAwB;QAAEC,SAAS,EAAE;MAAb,CAAxB,CAAhB;MACA,KAAKhD,QAAL,CAAciD,aAAd,CAA4BC,MAAM,CAACC,gBAAnC;MACA,KAAKnD,QAAL,CAAcoD,OAAd,CAAsBF,MAAM,CAACG,UAA7B,EAAyCH,MAAM,CAACI,WAAhD;MACA,KAAKtD,QAAL,CAAcuD,KAAd,GAAsB,IAAtB;MACA,KAAKvD,QAAL,CAAcwD,SAAd,CAAwBC,OAAxB,GAAkC,IAAlC;MACA,KAAKzD,QAAL,CAAcwD,SAAd,CAAwB3G,IAAxB,GAA+B6D,KAAK,CAACgD,gBAArC,CANW,CAM4C;;MACvD,KAAK1D,QAAL,CAAc2D,cAAd,GAA+B,IAA/B;MACA,KAAK7J,SAAL,CAAeqB,WAAf,CAA2B,KAAK6E,QAAL,CAAc/F,UAAzC;IACH;;;WAED,8BAAqB;MACjBiJ,MAAM,CAACU,gBAAP,CAAwB,QAAxB,EAAkC,YAAY;QAC1CzD,IAAI,CAAC0D,cAAL;MACH,CAFD,EAEG,KAFH;MAGAX,MAAM,CAACU,gBAAP,CAAwB,SAAxB,EAAmC,UAAUE,GAAV,EAAe;QAC9C,QAAQA,GAAG,CAACC,GAAZ;UACI,KAAK,WAAL;YACI5D,IAAI,CAACZ,MAAL,CAAYC,IAAZ,GAAmB,CAAnB;YACA,IAAIW,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4B,CAA5B,KAAkC,CAAC,CAAvC,EACI7D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBe,IAApB,CAAyB,CAAzB;YACJL,IAAI,CAACT,MAAL,GAAc,KAAd;YACA;;UACJ,KAAK,SAAL;YACIS,IAAI,CAACZ,MAAL,CAAYC,IAAZ,GAAmB,CAAnB;YACA,IAAIW,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4BpG,EAA5B,KAAmC,CAAC,CAAxC,EACIuC,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBe,IAApB,CAAyB5C,EAAzB;YACJuC,IAAI,CAACT,MAAL,GAAc,KAAd;YACA;;UACJ,KAAK,WAAL;YACIS,IAAI,CAACZ,MAAL,CAAYC,IAAZ,GAAmB,CAAnB;YACA,IAAIW,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4BvF,IAA5B,KAAqC,CAAC,CAA1C,EACI0B,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBe,IAApB,CAAyB/B,IAAzB;YACJ0B,IAAI,CAACT,MAAL,GAAc,KAAd;YACA;;UACJ,KAAK,YAAL;YACIS,IAAI,CAACZ,MAAL,CAAYC,IAAZ,GAAmB,CAAnB;YACA,IAAIW,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4BxF,IAA5B,KAAqC,CAAC,CAA1C,EACI2B,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBe,IAApB,CAAyBhC,IAAzB,EAHR,CAII;;YACA2B,IAAI,CAACT,MAAL,GAAc,KAAd;YACA;QAzBR;MA2BH,CA5BD,EA4BG,KA5BH;MA8BAwD,MAAM,CAACU,gBAAP,CAAwB,OAAxB,EAAiC,UAAUE,GAAV,EAAe;QAC5C;QACA,IAAIA,GAAG,CAACC,GAAJ,KAAY,WAAhB,EACI5D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBwE,MAApB,CAA2B9D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4B,CAA5B,CAA3B,EAA2D,CAA3D;QACJ,IAAIF,GAAG,CAACC,GAAJ,KAAY,SAAhB,EACI5D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBwE,MAApB,CAA2B9D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4BpG,EAA5B,CAA3B,EAA4D,CAA5D;QACJ,IAAIkG,GAAG,CAACC,GAAJ,KAAY,WAAhB,EACI5D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBwE,MAApB,CAA2B9D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4BvF,IAA5B,CAA3B,EAA8D,CAA9D;QACJ,IAAIqF,GAAG,CAACC,GAAJ,KAAY,YAAhB,EACI5D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBwE,MAApB,CAA2B9D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4BxF,IAA5B,CAA3B,EAA8D,CAA9D;;QACJ,IAAIsF,GAAG,CAACC,GAAJ,KAAY,WAAZ,IAA2BD,GAAG,CAACC,GAAJ,KAAY,SAAvC,IAAoDD,GAAG,CAACC,GAAJ,KAAY,YAAhE,IAAgFD,GAAG,CAACC,GAAJ,KAAY,WAAhG,EAA6G;UACzG,IAAI5D,IAAI,CAACZ,MAAL,CAAYE,OAAZ,CAAoByE,MAApB,KAA+B,CAAnC,EACI/D,IAAI,CAACT,MAAL,GAAc,aAAd;QACP,CAb2C,CAc5C;;MAEH,CAhBD,EAgBG,KAhBH;IAiBH;;;WAED,8BAAqB;MACjBxF,QAAQ,CAACoF,cAAT,CAAwB,YAAxB,EAAsC6E,OAAtC,GAAgD,YAAY;QACxDhE,IAAI,CAACiE,YAAL;MACH,CAFD;IAGH;;;WAED,qBAA0B;MAAA,IAAhBC,GAAgB,uEAAV,QAAU;MACtB,KAAKtE,KAAL,GAAa,IAAIW,KAAK,CAAC4D,KAAV,EAAb;MACA,KAAKvE,KAAL,CAAWrF,UAAX,GAAwB,IAAIgG,KAAK,CAAC6D,KAAV,CAAgBF,GAAhB,CAAxB,CAFsB,CAGtB;IACH;;;WAED,gBAAO;MACH,KAAKhF,IAAL,GAAY,KAAKV,KAAL,CAAWM,YAAvB;MAEA,KAAKuF,YAAL;MACA,KAAKC,SAAL;MAGA,KAAK1E,KAAL,CAAWmB,GAAX,CAAe,KAAKwD,eAAL,EAAf;MACA,KAAK3E,KAAL,CAAWmB,GAAX,CAAe,KAAKyD,gBAAL,EAAf;MAEA,KAAKC,aAAL;MACA,KAAKC,YAAL;MACA,KAAK5E,QAAL,GAAgB,IAAIS,KAAK,CAACoE,aAAV,CAAwB,KAAKnF,MAAL,CAAYC,MAApC,EAA4C,KAAKI,QAAL,CAAc/F,UAA1D,CAAhB,CAZG,CAcH;;MACA,IAAI,KAAKiG,KAAT,EAAgB;QACZ,KAAKJ,KAAL,GAAa,IAAIiF,KAAJ,EAAb;QACA,KAAKjL,SAAL,CAAeqB,WAAf,CAA2B,KAAK2E,KAAL,CAAWkF,GAAtC;MACH;;MACD,KAAKC,kBAAL,GAnBG,CAoBH;IACH;;;WAED,sBAAa;MACT,IAAMzJ,MAAM,GAAG,IAAIkF,KAAK,CAACwE,iBAAV,EAAf;MAEA,IAAMC,OAAO,GAAG3J,MAAM,CAAC3B,IAAP,CAAY,WACrB0E,UADqB,iCAErBA,UAFqB,iCAGrBA,UAHqB,iCAIrBA,UAJqB,iCAKrBA,UALqB,iCAMrBA,UANqB,sBAAZ,CAAhB;MAQA,KAAKwB,KAAL,CAAWrF,UAAX,GAAwByK,OAAxB;MACA,OAAQ,IAAR;IACH;;;WAED,yBAAgB3J,MAAhB,EAAwB;MAEpBA,MAAM,CAAC3B,IAAP,WACO0E,UADP,iBAEI,UAAUqB,MAAV,EAAkB;QACdO,IAAI,CAACJ,KAAL,CAAWmB,GAAX,CAAetB,MAAf;QACAA,MAAM,CAACwF,aAAP,GAAuB,IAAvB;QACAxF,MAAM,CAAC6C,UAAP,GAAoB,IAApB;QACA7C,MAAM,CAACyF,IAAP,GAAc,aAAd;QACAzF,MAAM,CAAC0F,QAAP,CAAgB,UAAUC,KAAV,EAAiB;UAC7B,IAAIA,KAAK,CAACC,MAAV,EAAkB;YACd,IAAID,KAAK,CAACF,IAAN,CAAWI,QAAX,CAAoB,MAApB,CAAJ,EAAiC;cAC7B;cACAF,KAAK,CAACpD,QAAN,CAAe,CAAf,IAAoB,IAAIzB,KAAK,CAACgF,oBAAV,CAA+B;gBAC/CC,YAAY,EAAE,GADiC;gBAE/CC,YAAY,EAAE,GAFiC;gBAG/CC,SAAS,EAAE,CAHoC;gBAI/CC,SAAS,EAAE,CAJoC;gBAK/CC,SAAS,EAAE,GALoC;gBAM/CC,kBAAkB,EAAE,IAN2B;gBAO/C3D,KAAK,EAAE,IAAI3B,KAAK,CAAC6D,KAAV,CAAgB,QAAhB,CAPwC;gBAQ/C0B,GAAG,EAAE;cAR0C,CAA/B,CAApB;cAUAV,KAAK,CAAC9C,UAAN,GAAmB,IAAnB;cACA8C,KAAK,CAACH,aAAN,GAAsB,IAAtB;YACH,CAdD,MAcO,IAAIG,KAAK,CAACF,IAAN,CAAWI,QAAX,CAAoB,WAApB,CAAJ,EAAsC;cACzCF,KAAK,CAACpD,QAAN,CAAe+D,OAAf,GAAyB,KAAzB;cACA/F,IAAI,CAACgG,gBAAL,GAAwBZ,KAAxB;YACH;UACJ;QACJ,CArBD;QAsBApF,IAAI,CAACiG,UAAL;QACAjG,IAAI,CAACkG,YAAL,CAAkB7K,MAAlB;MAEH,CAhCL,EAiCI,IAjCJ,EAkCI,KAAK8K,OAlCT;IAoCH;;;WAED,kCAAyB;MACrB,IAAMC,GAAG,GAAG,IAAI7F,KAAK,CAAC8F,KAAV,EAAZ;MACAD,GAAG,CAAClB,IAAJ,GAAW,aAAX;MACA,KAAKtF,KAAL,CAAWmB,GAAX,CAAeqF,GAAf;MAEA,IAAMtE,QAAQ,GAAG,IAAIvB,KAAK,CAAC+F,iBAAV,CAA4B,GAA5B,EAAiC,GAAjC,EAAsC,GAAtC,CAAjB;MACA,IAAMtE,QAAQ,GAAG,IAAIzB,KAAK,CAAC0B,iBAAV,CAA4B;QAAEC,KAAK,EAAE;MAAT,CAA5B,CAAjB;;MAEA,KAAK,IAAIqE,CAAC,GAAG,CAAC,IAAd,EAAoBA,CAAC,GAAG,IAAxB,EAA8BA,CAAC,IAAI,GAAnC,EAAwC;QACpC,KAAK,IAAIC,CAAC,GAAG,CAAC,IAAd,EAAoBA,CAAC,GAAG,IAAxB,EAA8BA,CAAC,IAAI,GAAnC,EAAwC;UACpC,IAAMC,KAAK,GAAG,IAAIlG,KAAK,CAAC6B,IAAV,CAAeN,QAAf,EAAyBE,QAAzB,CAAd;UACAyE,KAAK,CAACvM,QAAN,CAAegH,GAAf,CAAmBqF,CAAnB,EAAsB,EAAtB,EAA0BC,CAA1B;UACAJ,GAAG,CAACrF,GAAJ,CAAQ0F,KAAR;QACH;MACJ;;MAED,KAAKT,gBAAL,GAAwBI,GAAxB;IACH;;;WAED,yBAAgB;MACZ,IAAM/K,MAAM,GAAG,IAAIkF,KAAK,CAACmG,SAAV,EAAf;MACA,IAAM1G,IAAI,GAAG,IAAb;MACA3E,MAAM,CAAC3B,IAAP,WAAe0E,UAAf,eAAqC,UAAUqB,MAAV,EAAkB;QAEnDA,MAAM,CAACkH,KAAP,GAAe,IAAIpG,KAAK,CAACqG,cAAV,CAAyBnH,MAAzB,CAAf;QACAA,MAAM,CAAC6C,UAAP,GAAoB,IAApB;QACAtC,IAAI,CAACZ,MAAL,CAAYuH,KAAZ,GAAoBlH,MAAM,CAACkH,KAA3B;QACA3G,IAAI,CAACZ,MAAL,CAAYyH,IAAZ,GAAmBpH,MAAM,CAACkH,KAAP,CAAaG,OAAb,EAAnB;QAEArH,MAAM,CAACyF,IAAP,GAAc,WAAd;QACAzF,MAAM,CAAC0F,QAAP,CAAgB,UAAUC,KAAV,EAAiB;UAC7B,IAAIA,KAAK,CAACC,MAAV,EAAkB;YACdD,KAAK,CAAC9C,UAAN,GAAmB,IAAnB;YACA8C,KAAK,CAACH,aAAN,GAAsB,IAAtB;UACH;QACJ,CALD;QAMAjF,IAAI,CAACJ,KAAL,CAAWmB,GAAX,CAAetB,MAAf;QACAO,IAAI,CAACZ,MAAL,CAAYK,MAAZ,GAAqBA,MAArB;QACAO,IAAI,CAACZ,MAAL,CAAY2H,IAAZ,GAAmBtH,MAAM,CAACuH,UAAP,CAAkB,CAAlB,CAAnB;QAEAhH,IAAI,CAACiH,WAAL;QACAjH,IAAI,CAACkH,eAAL,CAAqB7L,MAArB;MACH,CApBD,EAoBG,IApBH,EAoBS,KAAK8K,OApBd;IAqBH;;;WAED,sBAAa9K,MAAb,EAAqB;MACjB,IAAI+E,IAAI,GAAG,KAAKH,KAAL,CAAWkH,GAAX,EAAX;MACA,IAAMnH,IAAI,GAAG,IAAb;MACA3E,MAAM,CAAC3B,IAAP,WACO0E,UADP,SACoBgC,IADpB,WAEI,UAAUX,MAAV,EAAkB;QACdO,IAAI,CAACZ,MAAL,CAAYgB,IAAZ,IAAoBX,MAAM,CAACuH,UAAP,CAAkB,CAAlB,CAApB;;QACA,IAAI5G,IAAI,KAAK,aAAb,EAA4B;UACxBJ,IAAI,CAACZ,MAAL,CAAYgB,IAAZ,EAAkBgH,IAAlB,GAAyB,KAAzB;QACH;;QACD,IAAIpH,IAAI,CAACC,KAAL,CAAW8D,MAAX,GAAoB,CAAxB,EAA2B;UACvB/D,IAAI,CAACkG,YAAL,CAAkB7K,MAAlB;QAEH,CAHD,MAGO;UACH,OAAO2E,IAAI,CAACC,KAAZ;UACAD,IAAI,CAACT,MAAL,GAAc,aAAd;UACAS,IAAI,CAACqH,kBAAL;UACArH,IAAI,CAACsH,OAAL;UACAtH,IAAI,CAACd,IAAL,GAAYc,IAAI,CAACxB,KAAL,CAAWQ,MAAvB;UACA,KAAKuI,kBAAL;QACH;MACJ,CAlBL,EAmBI,IAnBJ,EAoBI,KAAKpB,OApBT;IAsBH;;;WAED,8BAAqB;MACjB,IAAMqB,OAAO,GAAGzN,QAAQ,CAACoF,cAAT,CAAwB,SAAxB,CAAhB;MACAqI,OAAO,CAACC,SAAR,CAAkB1G,GAAlB,CAAsB,SAAtB;MACAyG,OAAO,CAAC/D,gBAAR,CACI,cADJ,EAEI,UAAUE,GAAV,EAAe;QACXA,GAAG,CAAC+D,MAAJ,CAAWzN,KAAX,CAAiBQ,OAAjB,GAA2B,MAA3B;MACH,CAJL,EAKI,KALJ;IAOH;;;WAED,6BAAoB;MAChBkN,UAAU,CAAC,YAAY;QACnB3H,IAAI,CAACZ,MAAL,CAAYwI,OAAZ,CAAoBC,MAApB,GAA6B7H,IAAI,CAACZ,MAAL,CAAYwI,OAAZ,CAAoBE,IAAjD;QACA9H,IAAI,CAACR,MAAL,CAAYE,IAAZ,GAAmB,IAAnB;QACAiI,UAAU,CAAC,YAAY;UACnB3H,IAAI,CAACR,MAAL,CAAYE,IAAZ,GAAmB,GAAnB;QACH,CAFS,EAEP,IAFO,CAAV;MAGH,CANS,EAMP,IANO,CAAV;IAOH;;;WAED,wBAA0B;MAAA,IAAbA,IAAa,uEAAN,IAAM;MACtB,IAAMqI,IAAI,GAAGtJ,MAAM,CAACuJ,IAAP,CAAY,KAAK5I,MAAL,CAAYwI,OAAxB,CAAb;MACAG,IAAI,CAACjE,MAAL,CAAYiE,IAAI,CAAClE,OAAL,CAAa,QAAb,CAAZ,EAAoC,CAApC;MACA,IAAIoE,KAAJ;;MACA,KAAK,IAAIzM,IAAT,IAAiB,KAAK4D,MAAL,CAAYwI,OAA7B,EAAsC;QAClC,IAAI,KAAKxI,MAAL,CAAYwI,OAAZ,CAAoBpM,IAApB,KAA6B,KAAK4D,MAAL,CAAYwI,OAAZ,CAAoBC,MAArD,EAA6D;UACzDI,KAAK,GAAGF,IAAI,CAAClE,OAAL,CAAarI,IAAb,IAAqB,CAA7B;UACA,IAAIyM,KAAK,IAAIF,IAAI,CAAChE,MAAlB,EAA0BkE,KAAK,GAAG,CAAR;UAC1B,KAAK7I,MAAL,CAAYwI,OAAZ,CAAoBC,MAApB,GAA6B,KAAKzI,MAAL,CAAYwI,OAAZ,CAAoBG,IAAI,CAACE,KAAD,CAAxB,CAA7B;UACA;QACH;MACJ;;MACD,KAAKzI,MAAL,CAAYE,IAAZ,GAAmBA,IAAnB;IACH;;;WAED,uBAAc;MACV,IAAMwI,KAAK,GAAG,IAAI3H,KAAK,CAAC4H,QAAV,EAAd;MACAD,KAAK,CAAChO,QAAN,CAAegH,GAAf,CAAmB,GAAnB,EAAwB,GAAxB,EAA6B,GAA7B;MACAgH,KAAK,CAACE,MAAN,GAAe,KAAKhJ,MAAL,CAAYK,MAA3B;MACA,IAAMqI,IAAI,GAAG,IAAIvH,KAAK,CAAC4H,QAAV,EAAb;MACAL,IAAI,CAAC5N,QAAL,CAAcgH,GAAd,CAAkB,CAAlB,EAAqB,GAArB,EAA0B,CAAC,GAA3B;MACA4G,IAAI,CAACM,MAAL,GAAc,KAAKhJ,MAAL,CAAYK,MAA1B;MACA,IAAM4I,IAAI,GAAG,IAAI9H,KAAK,CAAC4H,QAAV,EAAb;MACAE,IAAI,CAACnO,QAAL,CAAcgH,GAAd,CAAkB,GAAlB,EAAuB,GAAvB,EAA4B,GAA5B;MACAmH,IAAI,CAACD,MAAL,GAAc,KAAKhJ,MAAL,CAAYK,MAA1B;MACA,IAAM6I,QAAQ,GAAG,IAAI/H,KAAK,CAAC4H,QAAV,EAAjB;MACAG,QAAQ,CAACpO,QAAT,CAAkBgH,GAAlB,CAAsB,CAAtB,EAAyB,GAAzB,EAA8B,CAA9B;MACAoH,QAAQ,CAACF,MAAT,GAAkB,KAAKhJ,MAAL,CAAYK,MAA9B;MACA,IAAM8I,OAAO,GAAG,IAAIhI,KAAK,CAAC4H,QAAV,EAAhB;MACAI,OAAO,CAACrO,QAAR,CAAiBgH,GAAjB,CAAqB,EAArB,EAAyB,EAAzB,EAA6B,EAA7B;MACAqH,OAAO,CAACH,MAAR,GAAiB,KAAKhJ,MAAL,CAAYK,MAA7B;MAEA,KAAKL,MAAL,CAAYwI,OAAZ,GAAsB;QAAEM,KAAK,EAALA,KAAF;QAASJ,IAAI,EAAJA,IAAT;QAAeO,IAAI,EAAJA,IAAf;QAAqBC,QAAQ,EAARA,QAArB;QAA+BC,OAAO,EAAPA;MAA/B,CAAtB;MACA,KAAKnJ,MAAL,CAAYwI,OAAZ,CAAoBC,MAApB,GAA6B,KAAKzI,MAAL,CAAYwI,OAAZ,CAAoBS,IAAjD;MACA,KAAK7I,MAAL,CAAYE,IAAZ,GAAmB,CAAnB;MACA,KAAK8I,iBAAL;IACH;IAED;AACJ;AACA;AACA;AACA;AACA;;;;WACI,wBAA+F;MAAA,IAAlFC,GAAkF,uEAA5E,EAA4E;MAAA,IAAxEC,MAAwE,uEAA/D3F,MAAM,CAACG,UAAP,GAAoBH,MAAM,CAACI,WAAoC;MAAA,IAAvBwF,IAAuB,uEAAhB,CAAgB;MAAA,IAAbhG,GAAa,uEAAP,KAAO;MAC3F,IAAItI,KAAK,GAAG0I,MAAM,CAACG,UAAnB;MACA,IAAI5I,MAAM,GAAGyI,MAAM,CAACI,WAApB,CAF2F,CAG3F;;MACA,KAAK3D,MAAL,CAAYC,MAAZ,GAAqB,IAAIc,KAAK,CAACqI,iBAAV,CAA4BH,GAA5B,EAAiCC,MAAjC,EAAyCC,IAAzC,EAA+ChG,GAA/C,CAArB;IACH;IAED;AACJ;AACA;AACA;AACA;;;;WACI,0BAAiBkG,OAAjB,EAA0BC,OAA1B,EAAmC;MAC/B,IAAMC,GAAG,GAAG,IAAIxI,KAAK,CAACyI,OAAV,EAAZ;MACAD,GAAG,CAACxC,CAAJ,GAASsC,OAAO,GAAG,KAAKhJ,QAAL,CAAc/F,UAAd,CAAyBmP,WAApC,GAAmD,CAAnD,GAAuD,CAA/D;MACAF,GAAG,CAACG,CAAJ,GAAQ,EAAEJ,OAAO,GAAG,KAAKjJ,QAAL,CAAc/F,UAAd,CAAyBqP,YAArC,IAAqD,CAArD,GAAyD,CAAjE;MACA,OAAOJ,GAAP;IACH;;;SAED,aAAW7D,IAAX,EAAiB;MACb,IAAI,KAAK9F,MAAL,CAAYG,MAAZ,IAAsB2F,IAA1B,EAAgC;MAEhC,IAAM9E,IAAI,GAAG,KAAKhB,MAAL,CAAY8F,IAAZ,CAAb;MACA,IAAM3F,MAAM,GAAG,KAAKH,MAAL,CAAYuH,KAAZ,CAAkByC,UAAlB,CAA6BhJ,IAA7B,EAAmC,KAAKhB,MAAL,CAAYyH,IAA/C,CAAf;MACA,IAAIwC,SAAS,GAAG,CAAhB;MACA,IAAInE,IAAI,IAAI,aAAR,IAAyBA,IAAI,IAAI,gBAArC,EACI3F,MAAM,CAAC6H,IAAP,GAAc7G,KAAK,CAAC+I,QAApB;MACJ,KAAKlK,MAAL,CAAYG,MAAZ,GAAqB2F,IAArB;MACA,KAAK9F,MAAL,CAAYuH,KAAZ,CAAkB4C,aAAlB;MAEAhK,MAAM,CACDiK,KADL,GAEKC,qBAFL,CAE2BJ,SAF3B,EAGKK,kBAHL,CAGwB,CAHxB,EAIKC,MAJL,CAIY,GAJZ,EAKKC,IALL;MAOA,KAAKxK,MAAL,CAAYyK,UAAZ,GAAyBC,IAAI,CAACC,GAAL,EAAzB;IACH;;;WAED,8BAAqB;MACjB;MACA,IAAMC,GAAG,GAAG,IAAIzJ,KAAK,CAAC0J,OAAV,CAAkB,CAAlB,EAAqB,CAAC,CAAtB,EAAyB,CAAzB,CAAZ;MACA,IAAMlB,GAAG,GAAG,KAAK3J,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgQ,KAA5B,EAAZ;MACAnB,GAAG,CAACG,CAAJ,IAAS,GAAT;MACA,IAAMiB,SAAS,GAAG,IAAI5J,KAAK,CAAC6J,SAAV,CAAoBrB,GAApB,EAAyBiB,GAAzB,CAAlB;MACA,IAAMK,OAAO,GAAG,EAAhB;MACA,IAAMC,SAAS,GAAGH,SAAS,CAACI,eAAV,CAA0B,KAAKvE,gBAA/B,CAAlB;;MACA,IAAIsE,SAAS,CAACvG,MAAV,GAAmB,CAAvB,EAA0B;QACtB,KAAK3E,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAA5B,GAAgCH,GAAG,CAACG,CAAJ,GAAQoB,SAAS,CAAC,CAAD,CAAT,CAAaE,QAArD;MACH;IACJ;;;WAED,2BAAkBC,OAAlB,EAA2B;MACvB,IAAIA,OAAO,IAAI,CAAf,EACI,OAAO,KAAKrL,MAAL,CAAYC,IAAZ,CAAiBoL,OAAxB,CADJ,KAGI,KAAKrL,MAAL,CAAYC,IAAZ,CAAiBoL,OAAjB,GAA2BA,OAA3B;;MACJ,IAAIA,OAAO,GAAG,CAAd,EAAiB;QACb,KAAKlL,MAAL,GAAc,MAAd;MACH,CAFD,MAEO,IAAIkL,OAAO,GAAG,CAAC,GAAf,EAAoB;QACvB,KAAKlL,MAAL,GAAc,MAAd;MACH,CAFM,MAEA;QACH,KAAKA,MAAL,GAAc,aAAd;MACH;IACJ;;;WAED,2BAAkBmL,IAAlB,EAAwB;MACpB,IAAIA,IAAI,IAAI,CAAZ,EACI,OAAO,KAAKtL,MAAL,CAAYC,IAAZ,CAAiBqL,IAAxB,CADJ,KAGI,KAAKtL,MAAL,CAAYC,IAAZ,CAAiBqL,IAAjB,GAAwBA,IAAxB;IAEP;;;WAED,wBAAe3B,GAAf,EAAoB;MAChB,IAAIiB,GAAG,GAAG,IAAIzJ,KAAK,CAAC0J,OAAV,CAAkB,KAAK7K,MAAL,CAAYE,OAAZ,CAAoBiH,CAAtC,EAAyC,KAAKnH,MAAL,CAAYE,OAAZ,CAAoB4J,CAA7D,CAAV,CADgB,CAEhB;MACA;MACA;MACA;MAEA;;MACA,IAAIiB,SAAS,GAAG,IAAI5J,KAAK,CAAC6J,SAAV,CAAoBrB,GAApB,EAAyBiB,GAAzB,CAAhB;;MACA,IAAI,KAAKhE,gBAAL,IAAyBnM,SAA7B,EAAwC;QACpC,IAAMyQ,SAAS,GAAGH,SAAS,CAACI,eAAV,CAA0B,KAAKvE,gBAA/B,CAAlB;;QACA,IAAIsE,SAAS,CAACvG,MAAV,GAAmB,CAAvB,EAA0B;UACtB,IAAIuG,SAAS,CAAC,CAAD,CAAT,CAAaE,QAAb,GAAwB,EAA5B,EACI,OAAO,IAAP;QACP;MACJ;;MACD,OAAO,KAAP;IACH;;;WAED,qBAAYzB,GAAZ,EAAiB;MACb,IAAIiB,GAAG,GAAG,IAAIzJ,KAAK,CAAC0J,OAAV,EAAV;MACAD,GAAG,CAAC9I,GAAJ,CAAQ,CAAC,CAAT,EAAY,CAAZ,EAAe,CAAf;MACA8I,GAAG,CAACW,YAAJ,CAAiB,KAAKvL,MAAL,CAAYK,MAAZ,CAAmBmL,MAApC;MACAZ,GAAG,CAACa,SAAJ;MACA,IAAIV,SAAS,GAAG,IAAI5J,KAAK,CAAC6J,SAAV,CAAoBrB,GAApB,EAAyBiB,GAAzB,CAAhB;MAEA,IAAIM,SAAS,GAAGH,SAAS,CAACI,eAAV,CAA0B,KAAKvE,gBAA/B,CAAhB;;MACA,IAAIsE,SAAS,CAACvG,MAAV,GAAmB,CAAvB,EAA0B;QACtB,IAAIuG,SAAS,CAAC,CAAD,CAAT,CAAaE,QAAb,GAAwB,EAA5B,EACI,KAAKpL,MAAL,CAAYK,MAAZ,CAAmBqL,UAAnB,CAA8B,KAAKR,SAAS,CAAC,CAAD,CAAT,CAAaE,QAAhD;MACP;IACJ;;;WAED,sBAAazB,GAAb,EAAkB;MACd,IAAIiB,GAAG,GAAG,IAAIzJ,KAAK,CAAC0J,OAAV,EAAV;MACAD,GAAG,CAAC9I,GAAJ,CAAQ,CAAR,EAAW,CAAX,EAAc,CAAd;MACA8I,GAAG,CAACW,YAAJ,CAAiB,KAAKvL,MAAL,CAAYK,MAAZ,CAAmBmL,MAApC;MACAZ,GAAG,CAACa,SAAJ;MACA,IAAIV,SAAS,GAAG,IAAI5J,KAAK,CAAC6J,SAAV,CAAoBrB,GAApB,EAAyBiB,GAAzB,CAAhB;MAEA,IAAIM,SAAS,GAAGH,SAAS,CAACI,eAAV,CAA0B,KAAKvE,gBAA/B,CAAhB;;MACA,IAAIsE,SAAS,CAACvG,MAAV,GAAmB,CAAvB,EAA0B;QACtB,IAAIuG,SAAS,CAAC,CAAD,CAAT,CAAaE,QAAb,GAAwB,EAA5B,EACI,KAAKpL,MAAL,CAAYK,MAAZ,CAAmBqL,UAAnB,CAA8BR,SAAS,CAAC,CAAD,CAAT,CAAaE,QAAb,GAAwB,EAAtD;MACP;IAEJ;;;WAED,mBAAUzB,GAAV,EAAegC,EAAf,EAAmB;MACf,IAAIf,GAAG,GAAG,IAAIzJ,KAAK,CAAC0J,OAAV,EAAV;MACAD,GAAG,CAAC9I,GAAJ,CAAQ,CAAR,EAAW,CAAC,CAAZ,EAAe,CAAf;MACA6H,GAAG,CAACG,CAAJ,IAAS,GAAT;MACA,IAAIiB,SAAS,GAAG,IAAI5J,KAAK,CAAC6J,SAAV,CAAoBrB,GAApB,EAAyBiB,GAAzB,CAAhB;MACA,IAAMK,OAAO,GAAG,EAAhB;MAEA,IAAIC,SAAS,GAAGH,SAAS,CAACI,eAAV,CAA0B,KAAKvE,gBAA/B,CAAhB;;MACA,IAAIsE,SAAS,CAACvG,MAAV,GAAmB,CAAvB,EAA0B;QACtB,IAAMiH,OAAO,GAAGjC,GAAG,CAACG,CAAJ,GAAQoB,SAAS,CAAC,CAAD,CAAT,CAAaE,QAArC;;QACA,IAAIQ,OAAO,GAAG,KAAK5L,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAA1C,EAA6C;UACzC;UACA,KAAK9J,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAA5B,GACI,MAAM,KAAK9J,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAAlC,GAAsC,MAAM8B,OADhD;UAEA,KAAK5L,MAAL,CAAY6L,SAAZ,GAAwB,CAAxB;QACH,CALD,MAKO,IAAID,OAAO,GAAG,KAAK5L,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAA1C,EAA6C;UAChD;UACA,IAAI,KAAK9J,MAAL,CAAY6L,SAAZ,IAAyBpR,SAA7B,EAAwC,KAAKuF,MAAL,CAAY6L,SAAZ,GAAwB,CAAxB;UACxC,KAAK7L,MAAL,CAAY6L,SAAZ,IAAyBF,EAAE,GAAGV,OAA9B;UACA,KAAKjL,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAA5B,IAAiC,KAAK9J,MAAL,CAAY6L,SAA7C;;UACA,IAAI,KAAK7L,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAA5B,GAAgC8B,OAApC,EAA6C;YACzC,KAAK5L,MAAL,CAAY6L,SAAZ,GAAwB,CAAxB;YACA,KAAK7L,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAA5B,GAAgC8B,OAAhC;UACH;QACJ;MACJ;IACJ;;;WAGD,oBAAWD,EAAX,EAAe;MACX3N,OAAO,CAACC,GAAR,CAAY,QAAZ;MACA,IAAM0L,GAAG,GAAG,KAAK3J,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgQ,KAA5B,EAAZ;MACAnB,GAAG,CAACG,CAAJ,IAAS,EAAT;MACA,IAAIgC,OAAO,GAAG,KAAd;MACAA,OAAO,GAAG,KAAKC,cAAL,CAAoBpC,GAApB,CAAV;;MAGA,IAAI,CAACmC,OAAL,EAAc;QACV,IAAME,KAAK,GAAG,KAAKhM,MAAL,CAAYG,MAAZ,IAAsB,KAAtB,GAA8B,GAA9B,GAAoC,GAAlD,CADU,CAEV;QACA;;QACA,KAAKH,MAAL,CAAYK,MAAZ,CAAmB4L,UAAnB,CAA8BN,EAAE,GAAGK,KAAnC;MACH;;MACD,IAAI,KAAKpF,gBAAL,IAAyBnM,SAA7B,EAAwC;QACpC;QACA;QACA;QACA;QACA;QACA,KAAKyR,SAAL,CAAevC,GAAf,EAAoBgC,EAApB;MACH;IACJ;;;WACD,mBAAU;MACN,IAAIhC,GAAG,GAAG,KAAK3J,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgQ,KAA5B,EAAV;MAEA,KAAK1K,MAAL,CAAYC,MAAZ,CAAmBvF,QAAnB,CAA4BqM,CAA5B,GAAgCwC,GAAG,CAACxC,CAApC;MACA,KAAK/G,MAAL,CAAYC,MAAZ,CAAmBvF,QAAnB,CAA4BgP,CAA5B,GAAgCH,GAAG,CAACG,CAAJ,GAAQ,GAAxC;MACA,KAAK1J,MAAL,CAAYC,MAAZ,CAAmBvF,QAAnB,CAA4BsM,CAA5B,GAAgCuC,GAAG,CAACvC,CAAJ,GAAQ,GAAxC;MACA,KAAKhH,MAAL,CAAYC,MAAZ,CAAmB8L,MAAnB,CAA0BxC,GAA1B;IAEH;;;WAED,yBAAgB;MACZ,IAAI,KAAK3J,MAAL,CAAYwI,OAAZ,IAAuB,KAAKxI,MAAL,CAAYwI,OAAZ,CAAoBC,MAA/C,EAAuD;QACnD,KAAKrI,MAAL,CAAYC,MAAZ,CAAmBvF,QAAnB,CAA4BsR,IAA5B,CACI,KAAKpM,MAAL,CAAYwI,OAAZ,CAAoBC,MAApB,CAA2B4D,gBAA3B,CAA4C,IAAIlL,KAAK,CAAC0J,OAAV,EAA5C,CADJ,EAEI,KAAKzK,MAAL,CAAYE,IAFhB;QAIA,IAAIqJ,GAAJ;;QACA,IAAI,KAAK2C,YAAL,IAAqB7R,SAAzB,EAAoC;UAChC,KAAK2F,MAAL,CAAYC,MAAZ,CAAmBvF,QAAnB,CAA4ByR,IAA5B,CAAiC,KAAKD,YAAL,CAAkBxR,QAAnD;UACA6O,GAAG,GAAG,KAAK2C,YAAL,CAAkBhE,MAAxB;QACH,CAHD,MAGO;UACHqB,GAAG,GAAG,KAAK3J,MAAL,CAAYK,MAAZ,CAAmBvF,QAAnB,CAA4BgQ,KAA5B,EAAN;UACAnB,GAAG,CAACG,CAAJ,IAAS,EAAT;QACH;;QACD,KAAK1J,MAAL,CAAYC,MAAZ,CAAmB8L,MAAnB,CAA0BxC,GAA1B;MACH;IACJ;;;WAGD,mBAAU;MACN,IAAM/I,IAAI,GAAG,IAAb;MACA,IAAM+K,EAAE,GAAG,KAAKzK,KAAL,CAAWsL,QAAX,EAAX;MAEAC,qBAAqB,CAAC,YAAY;QAC9B7L,IAAI,CAACsH,OAAL;MACH,CAFoB,CAArB;MAIA,KAAKxH,QAAL,CAAcgM,MAAd,GARM,CASN;;MACA,IAAI,KAAK1M,MAAL,CAAYuH,KAAZ,IAAqB9M,SAArB,IAAkC,KAAKqF,IAAL,IAAa,KAAKV,KAAL,CAAWQ,MAA9D,EAAsE;QAClE,KAAKI,MAAL,CAAYuH,KAAZ,CAAkBmF,MAAlB,CAAyBf,EAAzB;MACH,CAZK,CAcN;;;MACA,IAAI,KAAK3L,MAAL,CAAYE,OAAZ,CAAoByE,MAApB,IAA8B,CAAlC,EACI,KAAKgI,UAAL,CAAgBhB,EAAhB;;MAEJ,IAAI,KAAK3L,MAAL,CAAYE,OAAZ,CAAoByE,MAApB,IAA8B,CAAlC,EAAqC;QACjC3G,OAAO,CAACC,GAAR,CAAY,KAAK+B,MAAL,CAAYE,OAAxB;QACA,IAAIoL,IAAJ;;QACA,IAAI,KAAKtL,MAAL,CAAYE,OAAZ,CAAoByE,MAApB,KAA+B,CAA/B,IACG,KAAK3E,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4B,CAA5B,MAAmC,CAAC,CADvC,IAEG,KAAKzE,MAAL,CAAYE,OAAZ,CAAoBuE,OAApB,CAA4BvF,IAA5B,MAAsC,CAAC,CAF9C,EAEiD;UAC7ClB,OAAO,CAACC,GAAR,CAAY,QAAZ;UACAD,OAAO,CAACC,GAAR,CAAYiB,IAAZ,EAAkBb,EAAE,GAAG,CAAvB;UACAiN,IAAI,GAAG,CAACpM,IAAI,GAAIb,EAAE,GAAG,CAAd,IAAoB,CAA3B;UACAL,OAAO,CAACC,GAAR,CAAYqN,IAAZ;QAEH,CARD,MASK;UACD,IAAIsB,GAAJ;;UACA,KAAK,IAAIC,CAAC,GAAG,CAAR,EAAWD,GAAG,GAAG,CAAtB,EAAyBC,CAAC,GAAG,KAAK7M,MAAL,CAAYE,OAAZ,CAAoByE,MAAjD,EAAyDiI,GAAG,IAAI,KAAK5M,MAAL,CAAYE,OAAZ,CAAoB2M,CAAC,EAArB,CAAhE;YAAyF;UAAzF;;UACAvB,IAAI,GAAGsB,GAAG,GAAG,KAAK5M,MAAL,CAAYE,OAAZ,CAAoByE,MAAjC;QAEH;;QAED/D,IAAI,CAACZ,MAAL,CAAYK,MAAZ,CAAmB2B,QAAnB,CAA4B8H,CAA5B,GAAgCwB,IAAhC;MACH,CAtCK,CAwCN;MACA;;;MAEA,KAAKwB,OAAL,GA3CM,CA4CN;;MACA,KAAKrM,QAAL,CAAcsM,MAAd,CAAqB,KAAKvM,KAA1B,EAAiC,KAAKJ,MAAL,CAAYC,MAA7C;MACA,IAAI,KAAKE,KAAL,IAAc9F,SAAlB,EAA6B,KAAK8F,KAAL,CAAWmM,MAAX;IAChC;;;WAED,iBAAQM,KAAR,EAAe;MACX,IAAMC,GAAG,GAAGjP,OAAO,CAACgP,KAAR,CAAcE,IAAI,CAACC,SAAL,CAAeH,KAAf,CAAd,CAAZ;MACAhP,OAAO,CAACgP,KAAR,CAAcA,KAAK,CAACI,OAApB;IACH;;;WAED,0BAAiB;MACb,KAAKhN,MAAL,CAAYC,MAAZ,CAAmBiJ,MAAnB,GAA4B3F,MAAM,CAACG,UAAP,GAAoBH,MAAM,CAACI,WAAvD;MACA,KAAK3D,MAAL,CAAYC,MAAZ,CAAmBgN,sBAAnB;MACA,KAAK5M,QAAL,CAAcoD,OAAd,CAAsBF,MAAM,CAACG,UAA7B,EAAyCH,MAAM,CAACI,WAAhD;IACH;;;;;;AAGL,IAAInD,IAAI,GAAG,IAAIzB,IAAJ,EAAX;;;ACtpBA,IAAImO,UAAU,GAAG,4BAAjB;AAEA,IAAIC,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAcC,MAA9B;;AAEA,SAASA,MAAT,CAAgBC,UAAhB,EAA4B;EAC1BJ,SAAS,CAACK,IAAV,CAAe,IAAf,EAAqBD,UAArB;EACA,KAAKE,GAAL,GAAW;IACTC,IAAI,EAAEN,MAAM,CAACC,MAAP,CAAcM,OADX;IAETC,gBAAgB,EAAE,EAFT;IAGTC,iBAAiB,EAAE,EAHV;IAITC,MAAM,EAAE,UAAUC,EAAV,EAAc;MACpB,KAAKH,gBAAL,CAAsB/M,IAAtB,CAA2BkN,EAAE,IAAI,YAAY,CAAE,CAA/C;IACD,CANQ;IAOTC,OAAO,EAAE,UAAUD,EAAV,EAAc;MACrB,KAAKF,iBAAL,CAAuBhN,IAAvB,CAA4BkN,EAA5B;IACD;EATQ,CAAX;EAYAX,MAAM,CAACC,MAAP,CAAcM,OAAd,GAAwB,IAAxB;AACD;;AAEDP,MAAM,CAACC,MAAP,CAAcC,MAAd,GAAuBA,MAAvB;AACA,IAAIW,aAAJ,EAAmBC,cAAnB;AAEA,IAAItF,MAAM,GAAGwE,MAAM,CAACC,MAAP,CAAczE,MAA3B;;AACA,IAAI,CAAC,CAACA,MAAD,IAAW,CAACA,MAAM,CAACuF,eAApB,KAAwC,OAAOC,SAAP,KAAqB,WAAjE,EAA8E;EAC5E,IAAIC,QAAQ,GAAG,MAA4BC,QAAQ,CAACD,QAApD;EACA,IAAIE,QAAQ,GAAGD,QAAQ,CAACC,QAAT,KAAsB,QAAtB,GAAiC,KAAjC,GAAyC,IAAxD;EACA,IAAIC,EAAE,GAAG,IAAIJ,SAAJ,CAAcG,QAAQ,GAAG,KAAX,GAAmBF,QAAnB,GAA8B,GAA9B,aAA2D,GAAzE,CAAT;;EACAG,EAAE,CAACC,SAAH,GAAe,UAASC,KAAT,EAAgB;IAC7BT,aAAa,GAAG,EAAhB;IACAC,cAAc,GAAG,EAAjB;IAEA,IAAIR,IAAI,GAAGZ,IAAI,CAAC6B,KAAL,CAAWD,KAAK,CAAChB,IAAjB,CAAX;;IAEA,IAAIA,IAAI,CAACxQ,IAAL,KAAc,QAAlB,EAA4B;MAC1B,IAAI0R,OAAO,GAAG,KAAd;MACAlB,IAAI,CAAC5T,MAAL,CAAY6G,OAAZ,CAAoB,UAAS5G,KAAT,EAAgB;QAClC,IAAI,CAACA,KAAK,CAAC8U,KAAX,EAAkB;UAChB,IAAIC,SAAS,GAAGC,cAAc,CAACC,MAAM,CAACC,aAAR,EAAuBlV,KAAK,CAACmV,EAA7B,CAA9B;;UACA,IAAIJ,SAAJ,EAAe;YACbF,OAAO,GAAG,IAAV;UACD;QACF;MACF,CAPD,EAF0B,CAW1B;;MACAA,OAAO,GAAGA,OAAO,IAAIlB,IAAI,CAAC5T,MAAL,CAAYqV,KAAZ,CAAkB,UAASpV,KAAT,EAAgB;QACrD,OAAOA,KAAK,CAACmD,IAAN,KAAe,KAAf,IAAwBnD,KAAK,CAACqV,SAAN,CAAgBC,EAA/C;MACD,CAFoB,CAArB;;MAIA,IAAIT,OAAJ,EAAa;QACXhR,OAAO,CAAC0R,KAAR;QAEA5B,IAAI,CAAC5T,MAAL,CAAY6G,OAAZ,CAAoB,UAAU5G,KAAV,EAAiB;UACnCwV,QAAQ,CAACP,MAAM,CAACC,aAAR,EAAuBlV,KAAvB,CAAR;QACD,CAFD;QAIAmU,cAAc,CAACvN,OAAf,CAAuB,UAAU6O,CAAV,EAAa;UAClCC,YAAY,CAACD,CAAC,CAAC,CAAD,CAAF,EAAOA,CAAC,CAAC,CAAD,CAAR,CAAZ;QACD,CAFD;MAGD,CAVD,MAUO,IAAIlB,QAAQ,CAACoB,MAAb,EAAqB;QAAE;QAC5BpB,QAAQ,CAACoB,MAAT;MACD;IACF;;IAED,IAAIhC,IAAI,CAACxQ,IAAL,KAAc,QAAlB,EAA4B;MAC1BsR,EAAE,CAACmB,KAAH;;MACAnB,EAAE,CAACoB,OAAH,GAAa,YAAY;QACvBtB,QAAQ,CAACoB,MAAT;MACD,CAFD;IAGD;;IAED,IAAIhC,IAAI,CAACxQ,IAAL,KAAc,gBAAlB,EAAoC;MAClCU,OAAO,CAACC,GAAR,CAAY,2BAAZ;MAEAgS,kBAAkB;IACnB;;IAED,IAAInC,IAAI,CAACxQ,IAAL,KAAc,OAAlB,EAA2B;MACzBU,OAAO,CAACgP,KAAR,CAAc,kBAAkBc,IAAI,CAACd,KAAL,CAAWI,OAA7B,GAAuC,IAAvC,GAA8CU,IAAI,CAACd,KAAL,CAAWkD,KAAvE;MAEAD,kBAAkB;MAElB,IAAI7H,OAAO,GAAG+H,kBAAkB,CAACrC,IAAD,CAAhC;MACAnT,QAAQ,CAACoB,IAAT,CAAcH,WAAd,CAA0BwM,OAA1B;IACD;EACF,CA1DD;AA2DD;;AAED,SAAS6H,kBAAT,GAA8B;EAC5B,IAAI7H,OAAO,GAAGzN,QAAQ,CAACoF,cAAT,CAAwBuN,UAAxB,CAAd;;EACA,IAAIlF,OAAJ,EAAa;IACXA,OAAO,CAACgI,MAAR;EACD;AACF;;AAED,SAASD,kBAAT,CAA4BrC,IAA5B,EAAkC;EAChC,IAAI1F,OAAO,GAAGzN,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAd;EACAwN,OAAO,CAACkH,EAAR,GAAahC,UAAb,CAFgC,CAIhC;;EACA,IAAIF,OAAO,GAAGzS,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAd;EACA,IAAIyV,UAAU,GAAG1V,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAjB;EACAwS,OAAO,CAACkD,SAAR,GAAoBxC,IAAI,CAACd,KAAL,CAAWI,OAA/B;EACAiD,UAAU,CAACC,SAAX,GAAuBxC,IAAI,CAACd,KAAL,CAAWkD,KAAlC;EAEA9H,OAAO,CAACmI,SAAR,GACE,2NACE,mFADF,GAEE,yEAFF,GAGE,qEAHF,GAG0EnD,OAAO,CAACmD,SAHlF,GAG8F,QAH9F,GAIE,OAJF,GAIYF,UAAU,CAACE,SAJvB,GAImC,QAJnC,GAKA,QANF;EASA,OAAOnI,OAAP;AAED;;AAED,SAASoI,UAAT,CAAoB/C,MAApB,EAA4B6B,EAA5B,EAAgC;EAC9B,IAAImB,OAAO,GAAGhD,MAAM,CAACgD,OAArB;;EACA,IAAI,CAACA,OAAL,EAAc;IACZ,OAAO,EAAP;EACD;;EAED,IAAIC,OAAO,GAAG,EAAd;EACA,IAAIC,CAAJ,EAAOlT,CAAP,EAAUmT,GAAV;;EAEA,KAAKD,CAAL,IAAUF,OAAV,EAAmB;IACjB,KAAKhT,CAAL,IAAUgT,OAAO,CAACE,CAAD,CAAP,CAAW,CAAX,CAAV,EAAyB;MACvBC,GAAG,GAAGH,OAAO,CAACE,CAAD,CAAP,CAAW,CAAX,EAAclT,CAAd,CAAN;;MACA,IAAImT,GAAG,KAAKtB,EAAR,IAAeuB,KAAK,CAACC,OAAN,CAAcF,GAAd,KAAsBA,GAAG,CAACA,GAAG,CAACjM,MAAJ,GAAa,CAAd,CAAH,KAAwB2K,EAAjE,EAAsE;QACpEoB,OAAO,CAACzP,IAAR,CAAa0P,CAAb;MACD;IACF;EACF;;EAED,IAAIlD,MAAM,CAACzE,MAAX,EAAmB;IACjB0H,OAAO,GAAGA,OAAO,CAACK,MAAR,CAAeP,UAAU,CAAC/C,MAAM,CAACzE,MAAR,EAAgBsG,EAAhB,CAAzB,CAAV;EACD;;EAED,OAAOoB,OAAP;AACD;;AAED,SAASf,QAAT,CAAkBlC,MAAlB,EAA0BtT,KAA1B,EAAiC;EAC/B,IAAIsW,OAAO,GAAGhD,MAAM,CAACgD,OAArB;;EACA,IAAI,CAACA,OAAL,EAAc;IACZ;EACD;;EAED,IAAIA,OAAO,CAACtW,KAAK,CAACmV,EAAP,CAAP,IAAqB,CAAC7B,MAAM,CAACzE,MAAjC,EAAyC;IACvC,IAAImF,EAAE,GAAG,IAAI6C,QAAJ,CAAa,SAAb,EAAwB,QAAxB,EAAkC,SAAlC,EAA6C7W,KAAK,CAACqV,SAAN,CAAgBC,EAA7D,CAAT;IACAtV,KAAK,CAAC8U,KAAN,GAAc,CAACwB,OAAO,CAACtW,KAAK,CAACmV,EAAP,CAAtB;IACAmB,OAAO,CAACtW,KAAK,CAACmV,EAAP,CAAP,GAAoB,CAACnB,EAAD,EAAKhU,KAAK,CAAC8W,IAAX,CAApB;EACD,CAJD,MAIO,IAAIxD,MAAM,CAACzE,MAAX,EAAmB;IACxB2G,QAAQ,CAAClC,MAAM,CAACzE,MAAR,EAAgB7O,KAAhB,CAAR;EACD;AACF;;AAED,SAASgV,cAAT,CAAwB1B,MAAxB,EAAgC6B,EAAhC,EAAoC;EAClC,IAAImB,OAAO,GAAGhD,MAAM,CAACgD,OAArB;;EACA,IAAI,CAACA,OAAL,EAAc;IACZ;EACD;;EAED,IAAI,CAACA,OAAO,CAACnB,EAAD,CAAR,IAAgB7B,MAAM,CAACzE,MAA3B,EAAmC;IACjC,OAAOmG,cAAc,CAAC1B,MAAM,CAACzE,MAAR,EAAgBsG,EAAhB,CAArB;EACD;;EAED,IAAIjB,aAAa,CAACiB,EAAD,CAAjB,EAAuB;IACrB;EACD;;EACDjB,aAAa,CAACiB,EAAD,CAAb,GAAoB,IAApB;EAEA,IAAI4B,MAAM,GAAGzD,MAAM,CAAC0D,KAAP,CAAa7B,EAAb,CAAb;EAEAhB,cAAc,CAACrN,IAAf,CAAoB,CAACwM,MAAD,EAAS6B,EAAT,CAApB;;EAEA,IAAI4B,MAAM,IAAIA,MAAM,CAACrD,GAAjB,IAAwBqD,MAAM,CAACrD,GAAP,CAAWG,gBAAX,CAA4BrJ,MAAxD,EAAgE;IAC9D,OAAO,IAAP;EACD;;EAED,OAAO6L,UAAU,CAACpB,MAAM,CAACC,aAAR,EAAuBC,EAAvB,CAAV,CAAqC8B,IAArC,CAA0C,UAAU9B,EAAV,EAAc;IAC7D,OAAOH,cAAc,CAACC,MAAM,CAACC,aAAR,EAAuBC,EAAvB,CAArB;EACD,CAFM,CAAP;AAGD;;AAED,SAASO,YAAT,CAAsBpC,MAAtB,EAA8B6B,EAA9B,EAAkC;EAChC,IAAI4B,MAAM,GAAGzD,MAAM,CAAC0D,KAAP,CAAa7B,EAAb,CAAb;EACA7B,MAAM,CAACM,OAAP,GAAiB,EAAjB;;EACA,IAAImD,MAAJ,EAAY;IACVA,MAAM,CAACrD,GAAP,CAAWC,IAAX,GAAkBL,MAAM,CAACM,OAAzB;EACD;;EAED,IAAImD,MAAM,IAAIA,MAAM,CAACrD,GAAjB,IAAwBqD,MAAM,CAACrD,GAAP,CAAWI,iBAAX,CAA6BtJ,MAAzD,EAAiE;IAC/DuM,MAAM,CAACrD,GAAP,CAAWI,iBAAX,CAA6BlN,OAA7B,CAAqC,UAAUsQ,EAAV,EAAc;MACjDA,EAAE,CAAC5D,MAAM,CAACM,OAAR,CAAF;IACD,CAFD;EAGD;;EAED,OAAON,MAAM,CAAC0D,KAAP,CAAa7B,EAAb,CAAP;EACA7B,MAAM,CAAC6B,EAAD,CAAN;EAEA4B,MAAM,GAAGzD,MAAM,CAAC0D,KAAP,CAAa7B,EAAb,CAAT;;EACA,IAAI4B,MAAM,IAAIA,MAAM,CAACrD,GAAjB,IAAwBqD,MAAM,CAACrD,GAAP,CAAWG,gBAAX,CAA4BrJ,MAAxD,EAAgE;IAC9DuM,MAAM,CAACrD,GAAP,CAAWG,gBAAX,CAA4BjN,OAA5B,CAAoC,UAAUsQ,EAAV,EAAc;MAChDA,EAAE;IACH,CAFD;;IAGA,OAAO,IAAP;EACD;AACF","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["export class Preloader {\n    constructor(options) {\n        this.assets = {};\n        for (let asset of options.assets) {\n            this.assets[asset] = { loaded: 0, complete: false };\n            this.load(asset);\n        }\n        this.container = options.container;\n\n        if (options.onprogress == undefined) {\n            this.onprogress = onprogress;\n            this.domElement = document.createElement(\"div\");\n            this.domElement.style.position = \"absolute\";\n            this.domElement.style.top = \"0\";\n            this.domElement.style.left = \"0\";\n            this.domElement.style.width = \"100%\";\n            this.domElement.style.height = \"100%\";\n            this.domElement.style.background = \"#000\";\n            this.domElement.style.opacity = \"0.7\";\n            this.domElement.style.display = \"flex\";\n            this.domElement.style.alignItems = \"center\";\n            this.domElement.style.justifyContent = \"center\";\n            this.domElement.style.zIndex = \"1111\";\n            const barBase = document.createElement(\"div\");\n            barBase.style.background = \"#aaa\";\n            barBase.style.width = \"50%\";\n            barBase.style.minWidth = \"250px\";\n            barBase.style.borderRadius = \"10px\";\n            barBase.style.height = \"15px\";\n            this.domElement.appendChild(barBase);\n            const bar = document.createElement(\"div\");\n            bar.style.background = \"#2a2\";\n            bar.style.width = \"50%\";\n            bar.style.borderRadius = \"10px\";\n            bar.style.height = \"100%\";\n            bar.style.width = \"0\";\n            barBase.appendChild(bar);\n            this.progressBar = bar;\n            if (this.container != undefined) {\n                this.container.appendChild(this.domElement);\n            } else {\n                document.body.appendChild(this.domElement);\n            }\n        } else {\n            this.onprogress = options.onprogress;\n        }\n\n        this.oncomplete = options.oncomplete;\n\n        const loader = this;\n        function onprogress(delta) {\n            const progress = delta * 100;\n            loader.progressBar.style.width = `${progress}%`;\n        }\n    }\n\n    checkCompleted() {\n        for (let prop in this.assets) {\n            const asset = this.assets[prop];\n            if (!asset.complete) return false;\n        }\n        return true;\n    }\n\n    get progress() {\n        let total = 0;\n        let loaded = 0;\n\n        for (let prop in this.assets) {\n            const asset = this.assets[prop];\n            if (asset.total == undefined) {\n                loaded = 0;\n                break;\n            }\n            loaded += asset.loaded;\n            total += asset.total;\n        }\n\n        return loaded / total;\n    }\n\n    load(url) {\n        const loader = this;\n        var xobj = new XMLHttpRequest();\n        xobj.open(\"GET\", url, true);\n        xobj.onreadystatechange = function () {\n            if (xobj.readyState == 4 && xobj.status == \"200\") {\n                loader.assets[url].complete = true;\n                if (loader.checkCompleted()) {\n                    if (loader.domElement != undefined) {\n                        if (loader.container != undefined) {\n                            loader.container.removeChild(loader.domElement);\n                        } else {\n                            document.body.removeChild(loader.domElement);\n                        }\n                    }\n                    loader.oncomplete();\n                }\n            }\n        };\n        xobj.onprogress = function (e) {\n            const asset = loader.assets[url];\n            asset.loaded = e.loaded;\n            asset.total = e.total;\n            loader.onprogress(loader.progress);\n        };\n        xobj.send(null);\n    }\n}\n","export class Easing {\n    // t: current time, b: begInnIng value, c: change In value, d: duration\n    constructor(start, end, duration, startTime = 0, type = \"linear\") {\n        this.b = start;\n        this.c = end - start;\n        this.d = duration;\n        this.type = type;\n        this.startTime = startTime;\n    }\n\n    value(time) {\n        this.t = time - this.startTime;\n        return this[this.type]();\n    }\n\n    linear() {\n        return this.c * (this.t / this.d) + this.b;\n    }\n\n    inQuad() {\n        return this.c * (this.t /= this.d) * this.t + this.b;\n    }\n\n    outQuad() {\n        return -this.c * (this.t /= this.d) * (this.t - 2) + this.b;\n    }\n\n    inOutQuad() {\n        if ((this.t /= this.d / 2) < 1)\n            return (this.c / 2) * this.t * this.t + this.b;\n        return (-this.c / 2) * (--this.t * (this.t - 2) - 1) + this.b;\n    }\n\n    projectile() {\n        let c = this.c;\n        let b = this.b;\n        let t = this.t;\n        this.t *= 2;\n        let result;\n        let func;\n        if (this.t < this.d) {\n            result = this.outQuad();\n            func = \"outQuad\";\n        } else {\n            this.t -= this.d;\n            this.b += c;\n            this.c = -c;\n            result = this.inQuad();\n            func = \"inQuad\";\n        }\n        console.log(\n            \"projectile: \" +\n            result.toFixed(2) +\n            \" time:\" +\n            this.t.toFixed(2) +\n            \" func:\" +\n            func\n        );\n        this.b = b;\n        this.c = c;\n        this.t = t;\n        return result;\n    }\n\n    inCubic() {\n        return this.c * (this.t /= this.d) * this.t * this.t + this.b;\n    }\n\n    outCubic() {\n        return (\n            this.c * ((this.t = this.t / this.d - 1) * this.t * this.t + 1) + this.b\n        );\n    }\n\n    inOutCubic() {\n        if ((this.t /= this.d / 2) < 1)\n            return (this.c / 2) * this.t * this.t * this.t + this.b;\n        return (this.c / 2) * ((this.t -= 2) * this.t * this.t + 2) + this.b;\n    }\n\n    inQuart() {\n        return this.c * (this.t /= this.d) * this.t * this.t * this.t + this.b;\n    }\n\n    outQuart() {\n        return (\n            -this.c *\n            ((this.t = this.t / this.d - 1) * this.t * this.t * this.t - 1) +\n            this.b\n        );\n    }\n\n    inOutQuart() {\n        if ((this.t /= this.d / 2) < 1)\n            return (this.c / 2) * this.t * this.t * this.t * this.t + this.b;\n        return (\n            (-this.c / 2) * ((this.t -= 2) * this.t * this.t * this.t - 2) + this.b\n        );\n    }\n\n    inQuint() {\n        return (\n            this.c * (this.t /= this.d) * this.t * this.t * this.t * this.t + this.b\n        );\n    }\n\n    outQuint() {\n        return (\n            this.c *\n            ((this.t = this.t / this.d - 1) * this.t * this.t * this.t * this.t +\n                1) +\n            this.b\n        );\n    }\n\n    inOutQuint() {\n        if ((this.t /= this.d / 2) < 1)\n            return (this.c / 2) * this.t * this.t * this.t * this.t * this.t + this.b;\n        return (\n            (this.c / 2) * ((this.t -= 2) * this.t * this.t * this.t * this.t + 2) +\n            this.b\n        );\n    }\n\n    inSine() {\n        return (\n            -this.c * Math.cos((this.t / this.d) * (Math.PI / 2)) + this.c + this.b\n        );\n    }\n\n    outSine() {\n        return this.c * Math.sin((this.t / this.d) * (Math.PI / 2)) + this.b;\n    }\n\n    inOutSine() {\n        return (-this.c / 2) * (Math.cos((Math.PI * this.t) / this.d) - 1) + this.b;\n    }\n\n    inExpo() {\n        return this.t == 0\n            ? this.b\n            : this.c * Math.pow(2, 10 * (this.t / this.d - 1)) + this.b;\n    }\n\n    outExpo() {\n        return this.t == this.d\n            ? this.b + this.c\n            : this.c * (-Math.pow(2, (-10 * this.t) / this.d) + 1) + this.b;\n    }\n\n    inOutExpo() {\n        if (this.t == 0) return this.b;\n        if (this.t == this.d) return this.b + this.c;\n        if ((this.t /= this.d / 2) < 1)\n            return (this.c / 2) * Math.pow(2, 10 * (this.t - 1)) + this.b;\n        return (this.c / 2) * (-Math.pow(2, -10 * --this.t) + 2) + this.b;\n    }\n\n    inCirc() {\n        return -this.c * (Math.sqrt(1 - (this.t /= this.d) * this.t) - 1) + this.b;\n    }\n\n    outCirc() {\n        return (\n            this.c * Math.sqrt(1 - (this.t = this.t / this.d - 1) * this.t) + this.b\n        );\n    }\n\n    inOutCirc() {\n        if ((this.t /= this.d / 2) < 1)\n            return (-this.c / 2) * (Math.sqrt(1 - this.t * this.t) - 1) + this.b;\n        return (this.c / 2) * (Math.sqrt(1 - (this.t -= 2) * this.t) + 1) + this.b;\n    }\n\n    inElastic() {\n        let s = 1.70158,\n            p = 0,\n            a = this.c;\n        if (this.t == 0) return this.b;\n        if ((this.t /= this.d) == 1) return this.b + this.c;\n        if (!p) p = this.d * 0.3;\n        if (a < Math.abs(this.c)) {\n            a = this.c;\n            let s = p / 4;\n        } else {\n            let s = (p / (2 * Math.PI)) * Math.asin(this.c / a);\n        }\n        return (\n            -(\n                a *\n                Math.pow(2, 10 * (this.t -= 1)) *\n                Math.sin(((this.t * this.d - s) * (2 * Math.PI)) / p)\n            ) + this.b\n        );\n    }\n\n    outElastic() {\n        let s = 1.70158,\n            p = 0,\n            a = this.c;\n        if (this.t == 0) return this.b;\n        if ((this.t /= this.d) == 1) return this.b + this.c;\n        if (!p) p = this.d * 0.3;\n        if (a < Math.abs(this.c)) {\n            a = this.c;\n            let s = p / 4;\n        } else {\n            let s = (p / (2 * Math.PI)) * Math.asin(this.c / a);\n        }\n        return (\n            a *\n            Math.pow(2, -10 * this.t) *\n            Math.sin(((this.t * this.d - s) * (2 * Math.PI)) / p) +\n            this.c +\n            this.b\n        );\n    }\n\n    inOutElastic() {\n        let s = 1.70158,\n            p = 0,\n            a = this.c;\n        if (this.t == 0) return this.b;\n        if ((this.t /= this.d / 2) == 2) return this.b + this.c;\n        if (!p) p = this.d * (0.3 * 1.5);\n        if (a < Math.abs(this.c)) {\n            a = this.c;\n            let s = p / 4;\n        } else {\n            let s = (p / (2 * Math.PI)) * Math.asin(this.c / a);\n        }\n        if (this.t < 1)\n            return (\n                -0.5 *\n                (a *\n                    Math.pow(2, 10 * (this.t -= 1)) *\n                    Math.sin(((this.t * this.d - s) * (2 * Math.PI)) / p)) +\n                this.b\n            );\n        return (\n            a *\n            Math.pow(2, -10 * (this.t -= 1)) *\n            Math.sin(((this.t * this.d - s) * (2 * Math.PI)) / p) *\n            0.5 +\n            this.c +\n            this.b\n        );\n    }\n\n    inBack() {\n        let s = 1.70158;\n        return (\n            this.c * (this.t /= this.d) * this.t * ((s + 1) * this.t - s) + this.b\n        );\n    }\n\n    outBack() {\n        let s = 1.70158;\n        return (\n            this.c *\n            ((this.t = this.t / this.d - 1) * this.t * ((s + 1) * this.t + s) + 1) +\n            this.b\n        );\n    }\n\n    inOutBack() {\n        let s = 1.70158;\n        if ((this.t /= this.d / 2) < 1)\n            return (\n                (this.c / 2) * (this.t * this.t * (((s *= 1.525) + 1) * this.t - s)) +\n                this.b\n            );\n        return (\n            (this.c / 2) *\n            ((this.t -= 2) * this.t * (((s *= 1.525) + 1) * this.t + s) + 2) +\n            this.b\n        );\n    }\n\n    inBounce(t = this.t, b = this.b) {\n        return this.c - this.outBounce(this.d - t, 0) + b;\n    }\n\n    outBounce(t = this.t, b = this.b) {\n        if ((t /= this.d) < 1 / 2.75) {\n            return this.c * (7.5625 * t * t) + b;\n        } else if (t < 2 / 2.75) {\n            return this.c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n        } else if (t < 2.5 / 2.75) {\n            return this.c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n        } else {\n            return this.c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n        }\n    }\n\n    inOutBounce() {\n        if (this.t < this.d / 2) return this.inBounce(this.t * 2, 0) * 0.5 + this.b;\n        return this.outBounce(this.t * 2 - this.d, 0) * 0.5 + this.c * 0.5 + this.b;\n    }\n}","import { Preloader } from \"./Preloader\"\nimport { Easing } from \"./Easing\";\nconst ASSET_PATH = \"https://raw.githubusercontent.com/mgavillo/files/master/\"\nconst PI = 3.141592653;\nconst PI_2 = 1.570796326;\nconst PI_3 = (3 * Math.PI) / 2;\nclass Game {\n    constructor() {\n        this.modes = Object.freeze({\n            NONE: Symbol(\"none\"),\n            PRELOAD: Symbol(\"preload\"),\n            INITIALISING: Symbol(\"initialising\"),\n            CREATING_LEVEL: Symbol(\"creating_level\"),\n            ACTIVE: Symbol(\"active\"),\n            GAMEOVER: Symbol(\"gameover\")\n        });\n        this.mode = this.modes.NONE;\n\n        this.container = document.getElementById('renderContainer')\n        this.player = {\n            move: 0,\n            moveDir: [],\n            action: null\n        };\n        this.camera = { object: {}, fade: 0.05 }\n        this.stats;\n        this.scene;\n        this.renderer;\n        this.controls;\n        this.debug = true;\n        const game = this;\n        this.anims = [\n            \"look-around\",\n            \"ascend-stairs\",\n            \"gather-objects\",\n            \"push-button\",\n            \"run\"\n        ];\n        const options = {\n            assets: [\n            ],\n            oncomplete: function () {\n                game.init();\n            }\n        };\n        this.anims.forEach(function (anim) {\n            options.assets.push(`${ASSET_PATH}${anim}.fbx`);\n        });\n\n        this.mode = this.modes.PRELOAD;\n\n        this.clock = new THREE.Clock();\n        const preloader = new Preloader(options);\n    }\n\n\n    hemisphereLight(sky = 0xE7D0A7, ground = 0x795939, intensity = 1) {\n        const light1 = new THREE.AmbientLight(0x404040); // soft white light\n        this.scene.add(light1);\n        const light = new THREE.HemisphereLight(sky, ground, intensity);\n        light.position.set(0, 200, 0);\n        return light\n    }\n\n    lensFlare() {\n        const light = new THREE.PointLight(0xffffff, 1.5, 2000);\n        light.position.set([0, 0, 60]);\n        light.rotation.set([0, 90, 0])\n        const textureLoader = new THREE.TextureLoader();\n\n        const textureFlare0 = textureLoader.load(`${ASSET_PATH}lensFlare-01.png`);\n        const textureFlare1 = textureLoader.load(`${ASSET_PATH}lensFlare1-02.png`);\n        const textureFlare2 = textureLoader.load(`${ASSET_PATH}lensFlare2-03.png`);\n\n        const lensflare = new THREE.Lensflare();\n        lensflare.addElement(new THREE.LensflareElement(textureFlare0, 512, 0));\n        lensflare.addElement(new THREE.LensflareElement(textureFlare1, 512, 10));\n        lensflare.addElement(new THREE.LensflareElement(textureFlare2, 60, 0.6));\n\n        const geometry = new THREE.BoxGeometry(0, 10, 0);\n        const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });\n        const cube = new THREE.Mesh(geometry, material);\n        this.cube.position = [0, 10, 0]\n        this.scene.add(cube);\n\n        light.add(lensflare)\n    }\n    directionalLight(color = 0xf0e2c1) {\n        const light = new THREE.DirectionalLight(color);\n        light.position.set(10, 10, 10);\n        light.rotation.set([0, -76.5494, 0])\n        light.castShadow = true;\n        light.shadow.mapSize.width = 2048;\n        light.shadow.mapSize.height = 2048;\n        light.shadow.camera.top = 3000;\n        light.shadow.camera.bottom = -3000;\n        light.shadow.camera.left = -3000;\n        light.shadow.camera.right = 3000;\n        light.shadow.camera.far = 3000;\n        // light.add(this.lensFlare())\n        return (light)\n    }\n\n\n\n    initRenderer() {\n        this.renderer = new THREE.WebGLRenderer({ antialias: true });\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setSize(window.innerWidth, window.innerHeight);\n        this.renderer.alpha = true;\n        this.renderer.shadowMap.enabled = true;\n        this.renderer.shadowMap.type = THREE.PCFSoftShadowMap; // default THREE.PCFShadowMap\n        this.renderer.shadowMapDebug = true;\n        this.container.appendChild(this.renderer.domElement);\n    }\n\n    addWindowListeners() {\n        window.addEventListener(\"resize\", function () {\n            game.onWindowResize();\n        }, false);\n        window.addEventListener(\"keydown\", function (evt) {\n            switch (evt.key) {\n                case 'ArrowDown':\n                    game.player.move = 1\n                    if (game.player.moveDir.indexOf(0) == -1)\n                        game.player.moveDir.push(0)\n                    game.action = \"run\"\n                    break;\n                case 'ArrowUp':\n                    game.player.move = 1\n                    if (game.player.moveDir.indexOf(PI) == -1)\n                        game.player.moveDir.push(PI)\n                    game.action = \"run\"\n                    break;\n                case 'ArrowLeft':\n                    game.player.move = 1\n                    if (game.player.moveDir.indexOf(PI_3) == -1)\n                        game.player.moveDir.push(PI_3)\n                    game.action = \"run\"\n                    break;\n                case 'ArrowRight':\n                    game.player.move = 1\n                    if (game.player.moveDir.indexOf(PI_2) == -1)\n                        game.player.moveDir.push(PI_2)\n                    // game.player.object.rotation.y = Math.PI/2;\n                    game.action = \"run\"\n                    break;\n            }\n        }, false)\n\n        window.addEventListener(\"keyup\", function (evt) {\n            // game.playerControlMove(0)\n            if (evt.key === 'ArrowDown')\n                game.player.moveDir.splice(game.player.moveDir.indexOf(0), 1)\n            if (evt.key === 'ArrowUp')\n                game.player.moveDir.splice(game.player.moveDir.indexOf(PI), 1)\n            if (evt.key === 'ArrowLeft')\n                game.player.moveDir.splice(game.player.moveDir.indexOf(PI_3), 1)\n            if (evt.key === 'ArrowRight')\n                game.player.moveDir.splice(game.player.moveDir.indexOf(PI_2), 1)\n            if (evt.key === 'ArrowDown' || evt.key === 'ArrowUp' || evt.key === 'ArrowRight' || evt.key === 'ArrowLeft') {\n                if (game.player.moveDir.length === 0)\n                    game.action = \"look-around\"\n            }\n            // game.playerControlTurn(0)\n\n        }, false)\n    }\n\n    addButtonListeners() {\n        document.getElementById(\"camera-btn\").onclick = function () {\n            game.switchCamera();\n        };\n    }\n\n    initScene(col = 0x100005) {\n        this.scene = new THREE.Scene();\n        this.scene.background = new THREE.Color(col);\n        // this.scene.fog = new THREE.Fog(col, 500, 1500);\n    }\n\n    init() {\n        this.mode = this.modes.INITIALISING;\n\n        this.createCamera()\n        this.initScene()\n\n\n        this.scene.add(this.hemisphereLight());\n        this.scene.add(this.directionalLight());\n\n        this.loadFirstAnim()\n        this.initRenderer();\n        this.controls = new THREE.OrbitControls(this.camera.object, this.renderer.domElement);\n\n        // stats\n        if (this.debug) {\n            this.stats = new Stats();\n            this.container.appendChild(this.stats.dom);\n        }\n        this.addWindowListeners()\n        // this.addButtonListeners()\n    }\n\n    loadSkybox() {\n        const loader = new THREE.CubeTextureLoader();\n\n        const texture = loader.load([\n            `${ASSET_PATH}bluecloud_ft.jpg`,\n            `${ASSET_PATH}bluecloud_bk.jpg`,\n            `${ASSET_PATH}bluecloud_up.jpg`,\n            `${ASSET_PATH}bluecloud_dn.jpg`,\n            `${ASSET_PATH}bluecloud_rt.jpg`,\n            `${ASSET_PATH}bluecloud_lf.jpg`,\n        ]);\n        this.scene.background = texture;\n        return (null);\n    }\n\n    loadEnvironment(loader) {\n\n        loader.load(\n            `${ASSET_PATH}island.fbx`,\n            function (object) {\n                game.scene.add(object);\n                object.receiveShadow = true;\n                object.castShadow = true;\n                object.name = \"Environment\";\n                object.traverse(function (child) {\n                    if (child.isMesh) {\n                        if (child.name.includes(\"main\")) {\n                            // child.material[0] = new THREE.MeshLambertMaterial({ color: 0x8AE7D4, envMap: game.camera.renderTarget });\n                            child.material[0] = new THREE.MeshPhysicalMaterial({\n                                reflectivity: 1.0,\n                                transmission: 0.5,\n                                roughness: 0,\n                                metalness: 0,\n                                clearcoat: 0.3,\n                                clearcoatRoughness: 0.25,\n                                color: new THREE.Color(0x8AE7D4),\n                                ior: 1.5,\n                            })\n                            child.castShadow = true;\n                            child.receiveShadow = true;\n                        } else if (child.name.includes(\"mentproxy\")) {\n                            child.material.visible = false;\n                            game.environmentProxy = child;\n                        }\n                    }\n                });\n                game.loadSkybox();\n                game.loadNextAnim(loader);\n\n            },\n            null,\n            this.onError\n        );\n    }\n\n    createDummyEnvironment() {\n        const env = new THREE.Group();\n        env.name = \"Environment\";\n        this.scene.add(env);\n\n        const geometry = new THREE.BoxBufferGeometry(150, 150, 150);\n        const material = new THREE.MeshBasicMaterial({ color: 0xffff00 });\n\n        for (let x = -1000; x < 1000; x += 300) {\n            for (let z = -1000; z < 1000; z += 300) {\n                const block = new THREE.Mesh(geometry, material);\n                block.position.set(x, 75, z);\n                env.add(block);\n            }\n        }\n\n        this.environmentProxy = env;\n    }\n\n    loadFirstAnim() {\n        const loader = new THREE.FBXLoader();\n        const game = this;\n        loader.load(`${ASSET_PATH}test.fbx`, function (object) {\n\n            object.mixer = new THREE.AnimationMixer(object);\n            object.castShadow = true;\n            game.player.mixer = object.mixer;\n            game.player.root = object.mixer.getRoot();\n\n            object.name = \"Character\";\n            object.traverse(function (child) {\n                if (child.isMesh) {\n                    child.castShadow = true;\n                    child.receiveShadow = true;\n                }\n            });\n            game.scene.add(object);\n            game.player.object = object;\n            game.player.walk = object.animations[0];\n\n            game.initCameras();\n            game.loadEnvironment(loader);\n        }, null, this.onError);\n    }\n\n    loadNextAnim(loader) {\n        let anim = this.anims.pop();\n        const game = this;\n        loader.load(\n            `${ASSET_PATH}${anim}.fbx`,\n            function (object) {\n                game.player[anim] = object.animations[0];\n                if (anim === \"push-button\") {\n                    game.player[anim].loop = false;\n                }\n                if (game.anims.length > 0) {\n                    game.loadNextAnim(loader);\n\n                } else {\n                    delete game.anims;\n                    game.action = \"look-around\";\n                    game.initPlayerPosition();\n                    game.animate();\n                    game.mode = game.modes.ACTIVE;\n                    this.initialOverlayAnim()\n                }\n            },\n            null,\n            this.onError\n        );\n    }\n\n    initialOverlayAnim() {\n        const overlay = document.getElementById(\"overlay\");\n        overlay.classList.add(\"fade-in\");\n        overlay.addEventListener(\n            \"animationend\",\n            function (evt) {\n                evt.target.style.display = \"none\";\n            },\n            false\n        );\n    }\n\n    initialCameraAnim() {\n        setTimeout(function () {\n            game.player.cameras.active = game.player.cameras.back;\n            game.camera.fade = 0.01;\n            setTimeout(function () {\n                game.camera.fade = 0.1;\n            }, 1500);\n        }, 2000);\n    }\n\n    switchCamera(fade = 0.05) {\n        const cams = Object.keys(this.player.cameras);\n        cams.splice(cams.indexOf(\"active\"), 1);\n        let index;\n        for (let prop in this.player.cameras) {\n            if (this.player.cameras[prop] == this.player.cameras.active) {\n                index = cams.indexOf(prop) + 1;\n                if (index >= cams.length) index = 0;\n                this.player.cameras.active = this.player.cameras[cams[index]];\n                break;\n            }\n        }\n        this.camera.fade = fade;\n    }\n\n    initCameras() {\n        const front = new THREE.Object3D();\n        front.position.set(112, 100, 200);\n        front.parent = this.player.object;\n        const back = new THREE.Object3D();\n        back.position.set(0, 400, -650);\n        back.parent = this.player.object;\n        const wide = new THREE.Object3D();\n        wide.position.set(178, 139, 465);\n        wide.parent = this.player.object;\n        const overhead = new THREE.Object3D();\n        overhead.position.set(0, 400, 0);\n        overhead.parent = this.player.object;\n        const collect = new THREE.Object3D();\n        collect.position.set(40, 82, 94);\n        collect.parent = this.player.object;\n\n        this.player.cameras = { front, back, wide, overhead, collect };\n        this.player.cameras.active = this.player.cameras.wide;\n        this.camera.fade = 1;\n        this.initialCameraAnim()\n    }\n\n    /**\n     * @param  {} fov=80\n     * @param  {} aspect=window.innerWidth/window.innerHeight\n     * @param  {} near=1\n     * @param  {} far=2000\n     */\n    createCamera(fov = 75, aspect = window.innerWidth / window.innerHeight, near = 1, far = 20000) {\n        var width = window.innerWidth;\n        var height = window.innerHeight;\n        // this.camera.object = new THREE.OrthographicCamera(width / - 2, width / 2, height / 2, height / - 2, near, far);\n        this.camera.object = new THREE.PerspectiveCamera(fov, aspect, near, far);\n    }\n\n    /**\n     * @param  {} clientX\n     * @param  {} clientY\n     * @return pos\n     */\n    getMousePosition(clientX, clientY) {\n        const pos = new THREE.Vector2();\n        pos.x = (clientX / this.renderer.domElement.clientWidth) * 2 - 1;\n        pos.y = -(clientY / this.renderer.domElement.clientHeight) * 2 + 1;\n        return pos;\n    }\n\n    set action(name) {\n        if (this.player.action == name) return;\n\n        const anim = this.player[name];\n        const action = this.player.mixer.clipAction(anim, this.player.root);\n        let timeScale = 1;\n        if (name == \"push-button\" || name == \"gather-objects\")\n            action.loop = THREE.LoopOnce;\n        this.player.action = name;\n        this.player.mixer.stopAllAction();\n\n        action\n            .reset()\n            .setEffectiveTimeScale(timeScale)\n            .setEffectiveWeight(1)\n            .fadeIn(0.5)\n            .play();\n\n        this.player.actionTime = Date.now();\n    }\n\n    initPlayerPosition() {\n        //cast down\n        const dir = new THREE.Vector3(0, -1, 0);\n        const pos = this.player.object.position.clone();\n        pos.y += 200;\n        const raycaster = new THREE.Raycaster(pos, dir);\n        const gravity = 30;\n        const intersect = raycaster.intersectObject(this.environmentProxy);\n        if (intersect.length > 0) {\n            this.player.object.position.y = pos.y - intersect[0].distance;\n        }\n    }\n\n    playerControlMove(forward) {\n        if (forward == 0)\n            delete this.player.move.forward;\n        else\n            this.player.move.forward = forward;\n        if (forward > 0) {\n            this.action = \"walk\";\n        } else if (forward < -0.2) {\n            this.action = \"walk\";\n        } else {\n            this.action = \"look-around\";\n        }\n    }\n\n    playerControlTurn(turn) {\n        if (turn == 0)\n            delete this.player.move.turn;\n        else\n            this.player.move.turn = turn;\n\n    }\n\n    blockedForward(pos) {\n        let dir = new THREE.Vector3(this.player.moveDir.x, this.player.moveDir.y);\n        // this.player.object.getWorldDirection(dir);\n        // if (this.player.move.forward < 0) {\n        //     console.log(\"negate\")\n        //     dir.negate();\n\n        // }\n        let raycaster = new THREE.Raycaster(pos, dir);\n        if (this.environmentProxy != undefined) {\n            const intersect = raycaster.intersectObject(this.environmentProxy);\n            if (intersect.length > 0) {\n                if (intersect[0].distance < 50)\n                    return true;\n            }\n        }\n        return false\n    }\n\n    blockedLeft(pos) {\n        let dir = new THREE.Vector3();\n        dir.set(-1, 0, 0);\n        dir.applyMatrix4(this.player.object.matrix);\n        dir.normalize();\n        let raycaster = new THREE.Raycaster(pos, dir);\n\n        let intersect = raycaster.intersectObject(this.environmentProxy);\n        if (intersect.length > 0) {\n            if (intersect[0].distance < 50)\n                this.player.object.translateX(50 - intersect[0].distance);\n        }\n    }\n\n    blockedRight(pos) {\n        let dir = new THREE.Vector3();\n        dir.set(1, 0, 0);\n        dir.applyMatrix4(this.player.object.matrix);\n        dir.normalize();\n        let raycaster = new THREE.Raycaster(pos, dir);\n\n        let intersect = raycaster.intersectObject(this.environmentProxy);\n        if (intersect.length > 0) {\n            if (intersect[0].distance < 50)\n                this.player.object.translateX(intersect[0].distance - 50);\n        }\n\n    }\n\n    bBoxFloor(pos, dt) {\n        let dir = new THREE.Vector3();\n        dir.set(0, -1, 0);\n        pos.y += 200;\n        let raycaster = new THREE.Raycaster(pos, dir);\n        const gravity = 60;\n\n        let intersect = raycaster.intersectObject(this.environmentProxy);\n        if (intersect.length > 0) {\n            const targetY = pos.y - intersect[0].distance;\n            if (targetY > this.player.object.position.y) {\n                //Going up\n                this.player.object.position.y =\n                    0.8 * this.player.object.position.y + 0.2 * targetY;\n                this.player.velocityY = 0;\n            } else if (targetY < this.player.object.position.y) {\n                //Falling\n                if (this.player.velocityY == undefined) this.player.velocityY = 0;\n                this.player.velocityY += dt * gravity;\n                this.player.object.position.y -= this.player.velocityY;\n                if (this.player.object.position.y < targetY) {\n                    this.player.velocityY = 0;\n                    this.player.object.position.y = targetY;\n                }\n            }\n        }\n    }\n\n\n    movePlayer(dt) {\n        console.log(\"coucou\")\n        const pos = this.player.object.position.clone();\n        pos.y += 60;\n        let blocked = false;\n        blocked = this.blockedForward(pos)\n\n\n        if (!blocked) {\n            const speed = this.player.action == \"run\" ? 200 : 100;\n            // this.player.object.position.x += this.player.moveDir.x * dt * speed\n            // this.player.object.position.z += this.player.moveDir.y * dt * speed\n            this.player.object.translateZ(dt * speed);\n        }\n        if (this.environmentProxy != undefined) {\n            // //cast left\n            // this.blockedLeft(pos)\n            // //cast right\n            // this.blockedRight(pos)\n            //cast down\n            this.bBoxFloor(pos, dt)\n        }\n    }\n    moveCam() {\n        var pos = this.player.object.position.clone();\n\n        this.camera.object.position.x = pos.x;\n        this.camera.object.position.y = pos.y + 600;\n        this.camera.object.position.z = pos.z + 600;\n        this.camera.object.lookAt(pos)\n\n    }\n\n    followWithCam() {\n        if (this.player.cameras && this.player.cameras.active) {\n            this.camera.object.position.lerp(\n                this.player.cameras.active.getWorldPosition(new THREE.Vector3()),\n                this.camera.fade\n            );\n            let pos;\n            if (this.cameraTarget != undefined) {\n                this.camera.object.position.copy(this.cameraTarget.position);\n                pos = this.cameraTarget.target;\n            } else {\n                pos = this.player.object.position.clone();\n                pos.y += 60;\n            }\n            this.camera.object.lookAt(pos);\n        }\n    }\n\n\n    animate() {\n        const game = this;\n        const dt = this.clock.getDelta();\n\n        requestAnimationFrame(function () {\n            game.animate();\n        });\n\n        this.controls.update();\n        //update player anim\n        if (this.player.mixer != undefined && this.mode == this.modes.ACTIVE) {\n            this.player.mixer.update(dt);\n        }\n\n        //player walk\n        if (this.player.moveDir.length != 0)\n            this.movePlayer(dt);\n\n        if (this.player.moveDir.length != 0) {\n            console.log(this.player.moveDir)\n            var turn;\n            if (this.player.moveDir.length === 2\n                && this.player.moveDir.indexOf(0) !== -1\n                && this.player.moveDir.indexOf(PI_3) !== -1) {\n                console.log(\"wsshhh\")\n                console.log(PI_3, PI * 2)\n                turn = (PI_3 + (PI * 2)) / 2\n                console.log(turn)\n\n            }\n            else {\n                var sum;\n                for (var i = 0, sum = 0; i < this.player.moveDir.length; sum += this.player.moveDir[i++]);\n                turn = sum / this.player.moveDir.length;\n\n            }\n\n            game.player.object.rotation.y = turn;\n        }\n\n        //rotate player\n        // if (this.player.move.turn != undefined) this.player.object.rotateY(this.player.move.turn * dt);\n\n        this.moveCam()\n        // this.followWithCam()\n        this.renderer.render(this.scene, this.camera.object);\n        if (this.stats != undefined) this.stats.update();\n    }\n\n    onError(error) {\n        const msg = console.error(JSON.stringify(error));\n        console.error(error.message);\n    }\n\n    onWindowResize() {\n        this.camera.object.aspect = window.innerWidth / window.innerHeight;\n        this.camera.object.updateProjectionMatrix();\n        this.renderer.setSize(window.innerWidth, window.innerHeight);\n    }\n}\n\nvar game = new Game();\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}